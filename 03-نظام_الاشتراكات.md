# ูุธุงู ุงูุงุดุชุฑุงูุงุช

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุงุดุชุฑุงูุงุช ูู ุงูุฌุณุฑ ุงูุฐู ูุฑุจุท ุจูู ุงูุฃุนุถุงุก ูุฎุทุท ุงูุนุถููุฉุ ุญูุซ ูุชูุญ ุฅูุดุงุก ูุฅุฏุงุฑุฉ ุงุดุชุฑุงูุงุช ุงูุฃุนุถุงุก ูู ุงููุงุฏู ุงูุฑูุงุถู. ูุชุนุงูู ูุฐุง ุงููุธุงู ูุน ุฏูุฑุฉ ุญูุงุฉ ุงูุงุดุชุฑุงู ุจุงููุงููุ ุจุฏุกูุง ูู ุฅูุดุงุก ุงูุงุดุชุฑุงูุ ูุฑูุฑูุง ุจุชุชุจุน ุญุงูุชูุ ูุงูุชูุงุกู ุจุชุฌุฏูุฏู ุฃู ุฅููุงุฆู.

## ๐ ุงููุธุงุฆู ุงูุฑุฆูุณูุฉ

### 1. ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช
- ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ ูุนุถู
- ุชุนุฏูู ุจูุงูุงุช ุงูุงุดุชุฑุงู
- ุชุฌุฏูุฏ ุงูุงุดุชุฑุงู
- ุฅูุบุงุก ุฃู ุชุฌููุฏ ุงูุงุดุชุฑุงู
- ูุชุงุจุนุฉ ุญุงูุฉ ุงูุงุดุชุฑุงู (ูุดุทุ ููุชููุ ูุฌูุฏ)

### 2. ุญุณุงุจ ุชูุงุฑูุฎ ุงูุงุดุชุฑุงู
- ุญุณุงุจ ุชุงุฑูุฎ ุจุฏุงูุฉ ุงูุงุดุชุฑุงู
- ุญุณุงุจ ุชุงุฑูุฎ ุงูุชูุงุก ุงูุงุดุชุฑุงู ุจูุงุกู ุนูู ุฎุทุฉ ุงูุนุถููุฉ
- ุชูุฏูุฏ ุงูุงุดุชุฑุงู (ุฅุถุงูุฉ ุฃูุงู ุฅุถุงููุฉ)
- ุชุนููุถ ุงูุฃูุงู ุงููุงุฆุชุฉ (ูู ุญุงูุฉ ุฅุบูุงู ุงููุงุฏู ูุซูุงู)

### 3. ุฅุฏุงุฑุฉ ุงูุญุตุต
- ุชุชุจุน ุนุฏุฏ ุงูุญุตุต ุงููุณุชุฎุฏูุฉ
- ุญุณุงุจ ุนุฏุฏ ุงูุญุตุต ุงููุชุจููุฉ
- ุฅุถุงูุฉ ุญุตุต ุฅุถุงููุฉ
- ุชุนููุถ ุงูุญุตุต ุงููุงุฆุชุฉ

### 4. ุฅุฏุงุฑุฉ ุงููุฏููุนุงุช
- ุฑุจุท ุงูุงุดุชุฑุงู ุจุงููุฏููุนุงุช
- ูุชุงุจุนุฉ ุญุงูุฉ ุงูุฏูุน (ูุฏููุน ุจุงููุงููุ ูุฏููุน ุฌุฒุฆููุงุ ุบูุฑ ูุฏููุน)
- ุญุณุงุจ ุงููุจูุบ ุงููุชุจูู
- ุฅูุดุงุก ููุงุชูุฑ ููุงุดุชุฑุงูุงุช

## ๐๏ธ ูููุฐุฌ ุจูุงูุงุช ุงูุงุดุชุฑุงู

```python
class Subscription(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    member_id = db.Column(db.Integer, db.ForeignKey('member.id'), nullable=False)
    plan_id = db.Column(db.Integer, db.ForeignKey('membership_plan.id'), nullable=False)
    start_date = db.Column(db.Date, nullable=False)
    end_date = db.Column(db.Date, nullable=False)
    status = db.Column(db.String(20), default='active')  # active, expired, frozen, cancelled
    total_sessions = db.Column(db.Integer, nullable=True)  # Null means unlimited
    remaining_sessions = db.Column(db.Integer, nullable=True)  # Null means unlimited
    price = db.Column(db.Float, nullable=False)
    discount = db.Column(db.Float, default=0)
    final_price = db.Column(db.Float, nullable=False)
    paid_amount = db.Column(db.Float, default=0)
    payment_status = db.Column(db.String(20), default='unpaid')  # unpaid, partially_paid, fully_paid
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    notes = db.Column(db.Text)
    frozen_days = db.Column(db.Integer, default=0)
    
    # ุงูุนูุงูุงุช
    invoices = db.relationship('Invoice', backref='subscription', lazy=True)
    attendances = db.relationship('Attendance', backref='subscription', lazy=True)
```

## ๐ ุงูุนูุงูุงุช ูุน ุงูุฃูุธูุฉ ุงูุฃุฎุฑู

### 1. ุงูุนูุงูุฉ ูุน ูุธุงู ุงูุฃุนุถุงุก
- ูู ุงุดุชุฑุงู ููุชูู ูุนุถู ูุงุญุฏ
- ูููู ููุนุถู ุฃู ูููู ูู ุนุฏุฉ ุงุดุชุฑุงูุงุช (ุชุงุฑูุฎูุฉ)
- ูููู ุฃู ูููู ููุนุถู ุงุดุชุฑุงู ูุดุท ูุงุญุฏ ููุท ูู ููุช ูุนูู

### 2. ุงูุนูุงูุฉ ูุน ูุธุงู ุฎุทุท ุงูุนุถููุฉ
- ูู ุงุดุชุฑุงู ูุฑุชุจุท ุจุฎุทุฉ ุนุถููุฉ ูุงุญุฏุฉ
- ุชุญุฏุฏ ุฎุทุฉ ุงูุนุถููุฉ ุฎุตุงุฆุต ุงูุงุดุชุฑุงู (ุงููุฏุฉุ ุงูุณุนุฑุ ุนุฏุฏ ุงูุญุตุต)

### 3. ุงูุนูุงูุฉ ูุน ูุธุงู ุงูุญุถูุฑ
- ูู ุชุณุฌูู ุญุถูุฑ ูุฑุชุจุท ุจุงุดุชุฑุงู ูุดุท
- ูุชู ุฎุตู ุญุตุฉ ูู ุงูุงุดุชุฑุงู ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑ (ุฅุฐุง ูุงู ุงูุงุดุชุฑุงู ูุญุฏูุฏ ุงูุญุตุต)

### 4. ุงูุนูุงูุฉ ูุน ูุธุงู ุงููุฏููุนุงุช ูุงูููุงุชูุฑ
- ูู ุงุดุชุฑุงู ูููู ุฃู ูููู ูู ุนุฏุฉ ููุงุชูุฑ ููุฏููุนุงุช
- ูุชู ุชุญุฏูุซ ุญุงูุฉ ุฏูุน ุงูุงุดุชุฑุงู ุจูุงุกู ุนูู ุงููุฏููุนุงุช

## ๐ ุงูุฅุญุตุงุฆูุงุช ูุงูุชูุงุฑูุฑ

### 1. ุฅุญุตุงุฆูุงุช ุงูุงุดุชุฑุงูุงุช
- ุนุฏุฏ ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ
- ุนุฏุฏ ุงูุงุดุชุฑุงูุงุช ุงูููุชููุฉ
- ุนุฏุฏ ุงูุงุดุชุฑุงูุงุช ุงููุฌูุฏุฉ
- ุฅุฌูุงูู ุฅูุฑุงุฏุงุช ุงูุงุดุชุฑุงูุงุช

### 2. ุชูุงุฑูุฑ ุงูุงุดุชุฑุงูุงุช
- ุชูุฑูุฑ ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ
- ุชูุฑูุฑ ุงูุงุดุชุฑุงูุงุช ุงูููุชููุฉ
- ุชูุฑูุฑ ุงูุงุดุชุฑุงูุงุช ุงูุชู ุณุชูุชูู ูุฑูุจูุง
- ุชูุฑูุฑ ุงููุฏููุนุงุช ุงููุชุฃุฎุฑุฉ

## ๐ฅ๏ธ ูุงุฌูุงุช ุงููุณุชุฎุฏู

### 1. ุตูุญุฉ ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช
- ุนุฑุถ ูุงุฆูุฉ ุงูุงุดุชุฑุงูุงุช ูุน ุฅููุงููุฉ ุงูุชุตููุฉ ูุงููุฑุฒ
- ุฎูุงุฑุงุช ููุจุญุซ ุนู ุงูุงุดุชุฑุงูุงุช
- ุฃุฒุฑุงุฑ ููุฅุฌุฑุงุกุงุช ุงูุณุฑูุนุฉ (ุชุนุฏููุ ุชุฌุฏูุฏุ ุชุฌููุฏุ ุฅูุบุงุก)

### 2. ุตูุญุฉ ุฅุถุงูุฉ/ุชุนุฏูู ุงุดุชุฑุงู
- ูููุฐุฌ ูุฅุฏุฎุงู ุจูุงูุงุช ุงูุงุดุชุฑุงู
- ุงุฎุชูุงุฑ ุงูุนุถู ูุฎุทุฉ ุงูุนุถููุฉ
- ุชุญุฏูุฏ ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
- ุฅุฏุฎุงู ุจูุงูุงุช ุงูุฏูุน

### 3. ุตูุญุฉ ุชูุงุตูู ุงูุงุดุชุฑุงู
- ุนุฑุถ ุจูุงูุงุช ุงูุงุดุชุฑุงู ุงููุงููุฉ
- ุนุฑุถ ุจูุงูุงุช ุงูุนุถู ูุฎุทุฉ ุงูุนุถููุฉ
- ุนุฑุถ ุณุฌู ุงูุญุถูุฑ ุงููุฑุชุจุท ุจุงูุงุดุชุฑุงู
- ุนุฑุถ ุงููุฏููุนุงุช ูุงูููุงุชูุฑ ุงููุฑุชุจุทุฉ ุจุงูุงุดุชุฑุงู

### 4. ุตูุญุฉ ุชุฌุฏูุฏ ุงูุงุดุชุฑุงู
- ุนุฑุถ ุจูุงูุงุช ุงูุงุดุชุฑุงู ุงูุญุงูู
- ุงุฎุชูุงุฑ ุฎุทุฉ ุงูุนุถููุฉ ููุชุฌุฏูุฏ
- ุชุญุฏูุฏ ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
- ุฅุฏุฎุงู ุจูุงูุงุช ุงูุฏูุน

## ๐๏ธ ุงูุฎุฏูุงุช ูุงููุธุงุฆู ุงููุชูุฏูุฉ

### 1. ุญุณุงุจ ุชูุงุฑูุฎ ุงูุงุดุชุฑุงู

```python
def calculate_subscription_dates(start_date, plan):
    """ุญุณุงุจ ุชุงุฑูุฎ ุงูุชูุงุก ุงูุงุดุชุฑุงู ุจูุงุกู ุนูู ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ูุฎุทุฉ ุงูุนุถููุฉ"""
    end_date = start_date + timedelta(days=plan.duration_days)
    return end_date

def extend_subscription(subscription, days):
    """ุชูุฏูุฏ ุงูุงุดุชุฑุงู ุจุฅุถุงูุฉ ุฃูุงู ุฅุถุงููุฉ"""
    subscription.end_date = subscription.end_date + timedelta(days=days)
    return subscription
```

### 2. ุฅุฏุงุฑุฉ ุญุงูุฉ ุงูุงุดุชุฑุงู

```python
def check_subscription_status(subscription):
    """ุงูุชุญูู ูู ุญุงูุฉ ุงูุงุดุชุฑุงู ูุชุญุฏูุซูุง ุฅุฐุง ูุฒู ุงูุฃูุฑ"""
    today = date.today()
    if subscription.status == 'active' and subscription.end_date < today:
        subscription.status = 'expired'
    return subscription.status

def freeze_subscription(subscription, days):
    """ุชุฌููุฏ ุงูุงุดุชุฑุงู ููุชุฑุฉ ูุญุฏุฏุฉ"""
    subscription.status = 'frozen'
    subscription.frozen_days += days
    subscription.end_date = subscription.end_date + timedelta(days=days)
    return subscription
```

### 3. ุฅุฏุงุฑุฉ ุงูุญุตุต

```python
def update_remaining_sessions(subscription, used_sessions=1):
    """ุชุญุฏูุซ ุนุฏุฏ ุงูุญุตุต ุงููุชุจููุฉ ุจุนุฏ ุชุณุฌูู ุงูุญุถูุฑ"""
    if subscription.remaining_sessions is not None:  # ุฅุฐุง ูุงู ุงูุงุดุชุฑุงู ูุญุฏูุฏ ุงูุญุตุต
        subscription.remaining_sessions -= used_sessions
        if subscription.remaining_sessions <= 0:
            subscription.remaining_sessions = 0
            # ูููู ุชุบููุฑ ุญุงูุฉ ุงูุงุดุชุฑุงู ุฅูู ููุชูู ุฅุฐุง ููุฏุช ุงูุญุตุต
    return subscription

def add_extra_sessions(subscription, extra_sessions):
    """ุฅุถุงูุฉ ุญุตุต ุฅุถุงููุฉ ููุงุดุชุฑุงู"""
    if subscription.remaining_sessions is not None:  # ุฅุฐุง ูุงู ุงูุงุดุชุฑุงู ูุญุฏูุฏ ุงูุญุตุต
        subscription.remaining_sessions += extra_sessions
        subscription.total_sessions += extra_sessions
    return subscription
```

## ๐ฑ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู

- ูุงุฌูุฉ ูุณุชุฎุฏู ุณููุฉ ุงูุงุณุชุฎุฏุงู
- ุนุฑุถ ุญุงูุฉ ุงูุงุดุชุฑุงู ุจุดูู ูุงุถุญ
- ุชูุจููุงุช ููุงุดุชุฑุงูุงุช ุงูุชู ุณุชูุชูู ูุฑูุจูุง
- ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ ููุนูููุงุช ุงููุชูุฑุฑุฉ

## ๐ ุงูุฃูุงู ูุงูุตูุงุญูุงุช

- ุชุญุฏูุฏ ุตูุงุญูุงุช ุฅูุดุงุก ูุชุนุฏูู ุงูุงุดุชุฑุงูุงุช
- ุชุณุฌูู ุงูุชุบููุฑุงุช ุนูู ุงูุงุดุชุฑุงูุงุช
- ุญูุงูุฉ ุจูุงูุงุช ุงูุงุดุชุฑุงูุงุช ูู ุงูุชุนุฏูู ุบูุฑ ุงููุตุฑุญ ุจู

## ๐ ููุฒุงุช ูุชูุฏูุฉ

### 1. ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู
- ุฅููุงููุฉ ุชูุนูู ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู ููุงุดุชุฑุงู
- ุฅุฑุณุงู ุชูุจููุงุช ูุจู ุงูุชุฌุฏูุฏ
- ุฅููุงููุฉ ุฅูุบุงุก ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู

### 2. ุงูุฎุตููุงุช ูุงูุนุฑูุถ
- ุชุทุจูู ุฎุตููุงุช ุนูู ุงูุงุดุชุฑุงูุงุช
- ุชูุฏูู ุนุฑูุถ ุฎุงุตุฉ ููุชุฌุฏูุฏ
- ุฎุตููุงุช ููุฏูุน ุงูููุฏู

### 3. ุงูุงุดุชุฑุงูุงุช ุงููุฌูุนุฉ
- ุฅููุงููุฉ ุฅูุดุงุก ุงุดุชุฑุงูุงุช ููุฌููุนุฉ ูู ุงูุฃุนุถุงุก
- ุชุทุจูู ุฎุตููุงุช ูููุฌููุนุงุช
- ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช ุงููุฌูุนุฉ

## ๐ก ุฃูุถู ุงูููุงุฑุณุงุช

- ุงูุชุญูู ูู ุญุงูุฉ ุงูุงุดุชุฑุงูุงุช ุจุดูู ุฏูุฑู
- ุฅุฑุณุงู ุชูุจููุงุช ููุงุดุชุฑุงูุงุช ุงูุชู ุณุชูุชูู ูุฑูุจูุง
- ุชูููุฑ ุฎูุงุฑุงุช ูุชุนุฏุฏุฉ ููุชุฌุฏูุฏ
- ุชุณููู ุนูููุฉ ุงูุชุฌุฏูุฏ
- ุงูุงุญุชูุงุธ ุจุณุฌู ูุงูู ูุชุงุฑูุฎ ุงูุงุดุชุฑุงูุงุช
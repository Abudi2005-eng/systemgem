# ุฎุทุฉ ุงูุชุญููู ูู ุชุทุจูู ููุจ Flask ุฅูู ุชุทุจูู ุณุทุญ ููุชุจ CustomTkinter

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ููุฏู ูุฐุง ุงููุณุชูุฏ ุฎุทุฉ ุดุงููุฉ ูุชุญููู ูุธุงู ุฅุฏุงุฑุฉ ุงููุงุฏู ุงูุฑูุงุถู ูู ุชุทุจูู ููุจ ูุจูู ุนูู Flask ุฅูู ุชุทุจูู ุณุทุญ ููุชุจ ุจุงุณุชุฎุฏุงู CustomTkinter. ุงููุฏู ูู ุงูุงุญุชูุงุธ ุจุฌููุน ุงููุธุงุฆู ูุงูุฎุตุงุฆุต ุงูุญุงููุฉ ูุน ุชูููููุง ูุจูุฆุฉ ุณุทุญ ุงูููุชุจุ ููุง ูุณูุญ ุจุชุดุบูู ุงููุธุงู ุจุฏูู ุงูุญุงุฌุฉ ุฅูู ุงุชุตุงู ุจุงูุฅูุชุฑูุช ูุจุดูู ุฃูุซุฑ ููุงุกุฉ.

## ๐ ููุงุฑูุฉ ุจูู ุงูุจูุฆุชูู

| ุงูุฌุงูุจ | ุชุทุจูู ููุจ Flask | ุชุทุจูู ุณุทุญ ููุชุจ CustomTkinter |
|--------|----------------|-----------------------------|
| **ูุงุฌูุฉ ุงููุณุชุฎุฏู** | HTML/CSS/JavaScript | CustomTkinter (Python) |
| **ูุงุนุฏุฉ ุงูุจูุงูุงุช** | SQLite/PostgreSQL (ุฎุงุฏู) | SQLite (ูุญูู) |
| **ุงููุตุงุฏูุฉ** | ุฌูุณุงุช ุงูููุจุ ุฑููุฒ JWT | ูุตุงุฏูุฉ ูุญููุฉ |
| **ุงูุชูุฒูุน** | ูุดุฑ ุนูู ุฎุงุฏู ููุจ | ุชุทุจูู ูุงุฆู ุจุฐุงุชู |
| **ุงูุชุญุฏูุซุงุช** | ูุฑูุฒูุฉ (ุชุญุฏูุซ ุงูุฎุงุฏู) | ุชุญุฏูุซุงุช ููุนููู |
| **ุงูุงุชุตุงู** | ูุชุทูุจ ุงุชุตุงู ุจุงูุฅูุชุฑูุช | ูุนูู ุจุฏูู ุงุชุตุงู |
| **ุงูุฃุฏุงุก** | ูุนุชูุฏ ุนูู ุณุฑุนุฉ ุงูุงุชุตุงู | ุฃุฏุงุก ูุญูู ุฃุณุฑุน |

## ๐๏ธ ุงููููู ุงูุนุงู ููุชุทุจูู ุงูุฌุฏูุฏ

```
gymawy-desktop/
โโโ app/
โ   โโโ controllers/        # ููุทู ุงูุชุญูู ูู ุงูุชุทุจูู
โ   โโโ models/             # ููุงุฐุฌ ุงูุจูุงูุงุช
โ   โโโ views/              # ูุงุฌูุงุช ุงููุณุชุฎุฏู CustomTkinter
โ   โโโ services/           # ุฎุฏูุงุช ุงููุธุงู ุงููุฎุชููุฉ
โ   โโโ utils/              # ุฃุฏูุงุช ูุณุงุนุฏุฉ
โ   โโโ assets/             # ุงูุตูุฑ ูุงูุฃููููุงุช ูุงูููุงุฑุฏ
โโโ config/                 # ูููุงุช ุงูุฅุนุฏุงุฏุงุช
โโโ database/               # ูููุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
โโโ docs/                   # ุชูุซูู ุงููุดุฑูุน
โโโ main.py                 # ููุทุฉ ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ ููุชุทุจูู
```

## ๐ป ุงุณุชุฑุงุชูุฌูุฉ ุงูุชุญููู

### 1. ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูููููุงุช

ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุงูููููุงุช ุงูุญุงููุฉ ูุน ุชุนุฏููุงุช ุทูููุฉ:

- **ุงูููุงุฐุฌ (Models)**: ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ููุงุฐุฌ ุงูุจูุงูุงุช ูุน ุชุนุฏูู ุทุฑููุฉ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช.
- **ุงูุฎุฏูุงุช (Services)**: ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ูุนุธู ุฎุฏูุงุช ุงูููุทู ุงูุชุฌุงุฑู.
- **ุงููุธุงุฆู ุงููุณุงุนุฏุฉ (Utils)**: ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ูุนุธู ุงููุธุงุฆู ุงููุณุงุนุฏุฉ.

### 2. ุชุญููู ูุงุฌูุงุช ุงููุณุชุฎุฏู

ูุฌุจ ุฅุนุงุฏุฉ ุจูุงุก ูุงุฌูุงุช ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู CustomTkinter:

- **ุชุญููู ุงูููุงูุจ HTML**: ุชุญููู ูู ูุงูุจ HTML ุฅูู ูุงูุฐุฉ ุฃู ุฅุทุงุฑ CustomTkinter.
- **ุชุญููู ุงูููุงุฐุฌ**: ุชุญููู ููุงุฐุฌ HTML ุฅูู ููุงุฐุฌ CustomTkinter.
- **ุชุญููู ุงูุฌุฏุงูู**: ุงุณุชุฎุฏุงู ููุชุจุงุช ูุซู Treeview ูุนุฑุถ ุงูุจูุงูุงุช ุงูุฌุฏูููุฉ.

### 3. ุชูููู ููุท MVC

- **ุงูููุงุฐุฌ (Models)**: ุงูุงุญุชูุงุธ ุจููุณ ุจููุฉ ุงูููุงุฐุฌ ูุน ุชุนุฏูู ุทุฑููุฉ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช.
- **ุงูุนุฑูุถ (Views)**: ุงุณุชุจุฏุงู ููุงูุจ Jinja2 ุจูุฆุงุช CustomTkinter.
- **ูุญุฏุงุช ุงูุชุญูู (Controllers)**: ุชุนุฏูู ูุญุฏุงุช ุงูุชุญูู ููุนูู ูุน ูุงุฌูุงุช CustomTkinter ุจุฏูุงู ูู ุทูุจุงุช HTTP.

## ๐ ุฎุทุฉ ุงูุชูููุฐ ุงููุฑุญููุฉ

### ุงููุฑุญูุฉ 1: ุงูุฅุนุฏุงุฏ ูุงูุชุญููู (1-2 ุฃุณุจูุน)

1. **ุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุชุทููุฑ**:
   - ุชุซุจูุช CustomTkinter ูุฌููุน ุงูููุชุจุงุช ุงููุงุฒูุฉ.
   - ุฅูุดุงุก ูููู ุงููุดุฑูุน ุงูุฌุฏูุฏ.

2. **ุชุญููู ุงูุชุทุจูู ุงูุญุงูู**:
   - ุชุญุฏูุฏ ุฌููุน ุงูุตูุญุงุช ูุงููุธุงุฆู.
   - ุชุญุฏูุฏ ุชุฏููุงุช ุงูุจูุงูุงุช ูุงูุนูููุงุช.
   - ุชุญุฏูุฏ ุงูููููุงุช ุงููุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู.

3. **ุชุตููู ูุงุฌูุฉ ุงููุณุชุฎุฏู**:
   - ุฅูุดุงุก ููุงุฐุฌ ุฃูููุฉ ููุงุฌูุงุช ุงููุณุชุฎุฏู ุงูุฑุฆูุณูุฉ.
   - ุชุญุฏูุฏ ุฃุณููุจ ูุณูุฉ ุงูุชุตููู.

### ุงููุฑุญูุฉ 2: ุชุญููู ุงูููุงุฐุฌ ูุงูุฎุฏูุงุช (2-3 ุฃุณุงุจูุน)

1. **ุชุญููู ููุงุฐุฌ ุงูุจูุงูุงุช**:
   - ููู ุชุนุฑููุงุช ุงูููุงุฐุฌ ูุน ุชุนุฏูู ORM ุฅุฐุง ูุฒู ุงูุฃูุฑ.
   - ุชูููู ุงูุนูุงูุงุช ุจูู ุงูููุงุฐุฌ.

2. **ุชุญููู ุงูุฎุฏูุงุช**:
   - ููู ุฎุฏูุงุช ุงูููุทู ุงูุชุฌุงุฑู ูุน ุงูุชุนุฏููุงุช ุงููุงุฒูุฉ.
   - ุชูููู ุฎุฏูุงุช ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช.

3. **ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ**:
   - ุฅูุดุงุก ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
   - ูุชุงุจุฉ ูุธุงุฆู ุงูุชุฑุญูู ูุงูุชููุฆุฉ.

### ุงููุฑุญูุฉ 3: ุจูุงุก ูุงุฌูุงุช ุงููุณุชุฎุฏู ุงูุฃุณุงุณูุฉ (3-4 ุฃุณุงุจูุน)

1. **ุฅูุดุงุก ุงููุงูุจ ุงูุฑุฆูุณู**:
   - ุจูุงุก ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ ูุน ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูุงูุดุฑูุท ุงูุนููู.
   - ุชูููุฐ ูุธุงู ุงูุชููู ุจูู ุงูุดุงุดุงุช.

2. **ุชุญููู ุงูุดุงุดุงุช ุงูุฑุฆูุณูุฉ**:
   - ููุญุฉ ุงูุชุญูู (Dashboard).
   - ุดุงุดุฉ ุชุณุฌูู ุงูุฏุฎูู.
   - ุดุงุดุงุช ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก ุงูุฃุณุงุณูุฉ.

3. **ุชูููุฐ ุงูููููุงุช ุงููุดุชุฑูุฉ**:
   - ูุฑุจุนุงุช ุงูุญูุงุฑ ุงููุดุชุฑูุฉ.
   - ุนูุงุตุฑ ุงูููุงุฐุฌ ุงููุฎุตุตุฉ.
   - ููููุงุช ุนุฑุถ ุงูุจูุงูุงุช.

### ุงููุฑุญูุฉ 4: ุชุญููู ูุญุฏุงุช ุงููุธุงู (4-6 ุฃุณุงุจูุน)

1. **ูุธุงู ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก**:
   - ุดุงุดุงุช ุนุฑุถ ูุฅุถุงูุฉ ูุชุนุฏูู ุงูุฃุนุถุงุก.
   - ุจุทุงูุงุช ุงูุนุถููุฉ ูุฅุฏุงุฑุฉ ุงูุตูุฑ.

2. **ูุธุงู ุงูุงุดุชุฑุงูุงุช ูุฎุทุท ุงูุนุถููุฉ**:
   - ุดุงุดุงุช ุฅุฏุงุฑุฉ ุฎุทุท ุงูุนุถููุฉ.
   - ุดุงุดุงุช ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช ูุงูุชุฌุฏูุฏ.

3. **ูุธุงู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู**:
   - ูุงุฌูุฉ ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู.
   - ุณุฌูุงุช ุงูุญุถูุฑ ูุงูุชูุงุฑูุฑ.

4. **ูุธุงู ุงููุฏููุนุงุช ูุงูููุงุชูุฑ**:
   - ุดุงุดุงุช ุฅุฏุงุฑุฉ ุงููุฏููุนุงุช.
   - ุฅูุดุงุก ูุทุจุงุนุฉ ุงูููุงุชูุฑ.

5. **ูุธุงู ุงูุชูุงุฑูุฑ**:
   - ุดุงุดุงุช ุฅูุดุงุก ูุนุฑุถ ุงูุชูุงุฑูุฑ.
   - ุชุตุฏูุฑ ุงูุชูุงุฑูุฑ ุจุชูุณููุงุช ูุฎุชููุฉ.

6. **ูุธุงู ุงููุฎุฒูู ูุงููุจูุนุงุช**:
   - ุดุงุดุงุช ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช ูุงููุฎุฒูู.
   - ุดุงุดุงุช ุงููุจูุนุงุช ูุงูุฎุฏูุงุช.

7. **ูุธุงู ุงูุฅุนุฏุงุฏุงุช**:
   - ุดุงุดุงุช ุฅุนุฏุงุฏุงุช ุงููุธุงู.
   - ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช.

### ุงููุฑุญูุฉ 5: ุงูุงุฎุชุจุงุฑ ูุงูุชุญุณูู (2-3 ุฃุณุงุจูุน)

1. **ุงุฎุชุจุงุฑ ุงููุธุงุฆู**:
   - ุงุฎุชุจุงุฑ ุฌููุน ูุธุงุฆู ุงููุธุงู.
   - ุงูุชุฃูุฏ ูู ุชุทุงุจู ุงูุณููู ูุน ุงููุธุงู ุงูุฃุตูู.

2. **ุชุญุณูู ุงูุฃุฏุงุก**:
   - ุชุญุณูู ุงุณุชุฌุงุจุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู.
   - ุชุญุณูู ุฃุฏุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช.

3. **ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**:
   - ุชูููุฐ ุงุฎุชุตุงุฑุงุช ููุญุฉ ุงูููุงุชูุญ.
   - ุชุญุณูู ุชุฏูู ุงูุนูู ูุณูููุฉ ุงูุงุณุชุฎุฏุงู.

### ุงููุฑุญูุฉ 6: ุงูุชูุฒูุน ูุงูุชูุซูู (1-2 ุฃุณุจูุน)

1. **ุฅุนุฏุงุฏ ุญุฒูุฉ ุงูุชูุฒูุน**:
   - ุฅูุดุงุก ููู ุชูููุฐู ูุงุฆู ุจุฐุงุชู.
   - ุฅุนุฏุงุฏ ุจุฑูุงูุฌ ุงูุชุซุจูุช.

2. **ุฅููุงู ุงูุชูุซูู**:
   - ุชูุซูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฌุฏูุฏุฉ.
   - ุชุญุฏูุซ ุฏููู ุงููุณุชุฎุฏู.

## ๐งฉ ุชูุงุตูู ุชูููุฐ ุงูููููุงุช ุงูุฑุฆูุณูุฉ

### 1. ูุธุงู ุงููุตู ุจูู ุงูุฌูุณูู

ูุนุชุจุฑ ุงููุตู ุจูู ุงูุฌูุณูู ูู ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ ูู ุงููุธุงูุ ุญูุซ ูุฌุจ ุชูููุฐู ุจุดูู ุฏููู ูู ุชุทุจูู ุณุทุญ ุงูููุชุจ ููุง ูู ูู ุชุทุจูู ุงูููุจ. ูููุง ููู ุชูุงุตูู ุชูููุฐ ูุฐู ุงูููุฒุฉ:

#### 1.1 ูููุฐุฌ ุงูุจูุงูุงุช ูุงูุชุนุฑููุงุช

```python
# app/utils/time_period_utils.py
from enum import Enum

class TimePeriod(Enum):
    MEN = "men"
    WOMEN = "women"
    BOTH = "both"

def get_current_time_period(user=None, session=None):
    """ุงูุญุตูู ุนูู ุงููุชุฑุฉ ุงูุฒูููุฉ ุงูุญุงููุฉ (ุฑุฌุงู/ุณูุฏุงุช) ุจูุงุกู ุนูู ุงููุณุชุฎุฏู ุงูุญุงูู ุฃู ุงูุฌูุณุฉ"""
    if user:
        return user.time_period
    elif session and "time_period" in session:
        return session["time_period"]
    return None

def get_allowed_time_periods_for_user(user):
    """ุชุญุฏูุฏ ุงููุชุฑุงุช ุงูุฒูููุฉ ุงููุณููุญ ุจูุง ูููุณุชุฎุฏู ุจูุงุกู ุนูู ุฏูุฑู ูุฌูุณู"""
    allowed_periods = [TimePeriod.BOTH.value]
    
    if user.is_admin:
        # ุงููุฏูุฑ ูุฏูู ูุตูู ูุงูู ูุฌููุน ุงููุชุฑุงุช
        allowed_periods.extend([TimePeriod.MEN.value, TimePeriod.WOMEN.value])
    elif user.gender == "female":
        # ุงูููุธูุงุช ูุฏููู ูุตูู ููุชุฑุฉ ุงูุณูุฏุงุช ููุท
        allowed_periods.append(TimePeriod.WOMEN.value)
    elif user.gender == "male":
        # ุงูููุธููู ูุฏููู ูุตูู ููุชุฑุฉ ุงูุฑุฌุงู ููุท
        allowed_periods.append(TimePeriod.MEN.value)
    
    return allowed_periods

def validate_time_period_access(user, requested_period):
    """ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุณุชุฎุฏู ูููุตูู ุฅูู ูุชุฑุฉ ุฒูููุฉ ูุญุฏุฏุฉ"""
    allowed_periods = get_allowed_time_periods_for_user(user)
    return requested_period in allowed_periods
```

#### 1.2 ุชุนุฏูู ูุธุงู ุงููุตุงุฏูุฉ

```python
# app/controllers/auth_controller.py
class AuthController:
    def __init__(self, db_service, security_service):
        self.db_service = db_service
        self.security_service = security_service
    
    def login(self, username, password, time_period):
        user = self.db_service.get_user_by_username(username)
        if user and self.security_service.verify_password(password, user.password_hash):
            # ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุตูู ูููุชุฑุฉ ุงููุทููุจุฉ
            from app.utils.time_period_utils import validate_time_period_access
            if validate_time_period_access(user, time_period):
                # ุชุญุฏูุซ ุขุฎุฑ ุชุณุฌูู ุฏุฎูู ูุงููุชุฑุฉ ุงูุฒูููุฉ
                user.last_login = datetime.now()
                user.time_period = time_period
                self.db_service.update_user(user)
                return user
        return None
```

#### 1.3 ุชุนุฏูู ูุงุฌูุฉ ุชุณุฌูู ุงูุฏุฎูู

```python
# app/views/auth_view.py
class LoginWindow(ctk.CTkToplevel):
    def __init__(self, parent, auth_controller):
        super().__init__(parent)
        self.auth_controller = auth_controller
        self.title("ุชุณุฌูู ุงูุฏุฎูู")
        self.geometry("400x400")
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.username_label = ctk.CTkLabel(self, text="ุงุณู ุงููุณุชุฎุฏู:")
        self.username_label.pack(pady=10)
        
        self.username_entry = ctk.CTkEntry(self, width=200)
        self.username_entry.pack(pady=5)
        
        self.password_label = ctk.CTkLabel(self, text="ูููุฉ ุงููุฑูุฑ:")
        self.password_label.pack(pady=10)
        
        self.password_entry = ctk.CTkEntry(self, width=200, show="*")
        self.password_entry.pack(pady=5)
        
        # ุฅุถุงูุฉ ุงุฎุชูุงุฑ ุงููุชุฑุฉ ุงูุฒูููุฉ
        self.period_label = ctk.CTkLabel(self, text="ุงููุชุฑุฉ ุงูุฒูููุฉ:")
        self.period_label.pack(pady=10)
        
        self.period_var = ctk.StringVar(value="men")
        self.period_men = ctk.CTkRadioButton(self, text="ูุชุฑุฉ ุงูุฑุฌุงู", variable=self.period_var, value="men")
        self.period_men.pack(pady=5)
        
        self.period_women = ctk.CTkRadioButton(self, text="ูุชุฑุฉ ุงูุณูุฏุงุช", variable=self.period_var, value="women")
        self.period_women.pack(pady=5)
        
        # ุฅุถุงูุฉ ููุงุญุธุฉ ุญูู ุงููุชุฑุงุช
        self.note_label = ctk.CTkLabel(self, text="ููุงุญุธุฉ: ูููู ููููุธููู ุงูุฐููุฑ ุงูุนูู ูู ูุชุฑุฉ ุงูุฑุฌุงู ููุทุ\nููููู ููููุธูุงุช ุงูุนูู ูู ูุชุฑุฉ ุงูุณูุฏุงุช ููุท.", text_color="gray70")
        self.note_label.pack(pady=10)
        
        self.login_button = ctk.CTkButton(self, text="ุชุณุฌูู ุงูุฏุฎูู", command=self.login)
        self.login_button.pack(pady=20)
        
        self.error_label = ctk.CTkLabel(self, text="", text_color="red")
        self.error_label.pack(pady=10)
    
    def login(self):
        username = self.username_entry.get()
        password = self.password_entry.get()
        time_period = self.period_var.get()
        
        user = self.auth_controller.login(username, password, time_period)
        if user:
            self.destroy()  # ุฅุบูุงู ูุงูุฐุฉ ุชุณุฌูู ุงูุฏุฎูู
            self.master.show_main_window(user)  # ุนุฑุถ ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
        else:
            self.error_label.configure(text="ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ\nุฃู ููุณ ูุฏูู ุตูุงุญูุฉ ูููุตูู ุฅูู ุงููุชุฑุฉ ุงููุญุฏุฏุฉ")
```

#### 1.4 ุชุนุฏูู ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ ูุนุฑุถ ุงููุชุฑุฉ ุงูุญุงููุฉ

```python
# app/views/main_window.py
class MainWindow(ctk.CTk):
    def __init__(self, auth_controller):
        super().__init__()
        self.auth_controller = auth_controller
        self.current_user = None
        
        # ... ุงูููุฏ ุงูุญุงูู ...
        
    def show_main_window(self, user):
        self.current_user = user
        
        # ุฅูุดุงุก ุงูุดุฑูุท ุงูุนููู ูุน ูุนูููุงุช ุงููุณุชุฎุฏู ูุงููุชุฑุฉ
        self.header_frame = ctk.CTkFrame(self)
        self.header_frame.pack(fill="x", padx=10, pady=5)
        
        # ุนุฑุถ ุงุณู ุงููุณุชุฎุฏู ูุงููุชุฑุฉ ุงูุญุงููุฉ
        period_text = "ูุชุฑุฉ ุงูุฑุฌุงู" if user.time_period == "men" else "ูุชุฑุฉ ุงูุณูุฏุงุช" if user.time_period == "women" else "ุฌููุน ุงููุชุฑุงุช"
        self.user_label = ctk.CTkLabel(self.header_frame, text=f"ูุฑุญุจุงู {user.name} | {period_text}")
        self.user_label.pack(side="right", padx=10)
        
        # ... ุจุงูู ุงูููุฏ ...
```

#### 1.5 ุชุนุฏูู ูุญุฏุงุช ุงูุชุญูู ููุชุญูู ูู ุตูุงุญูุงุช ุงููุตูู

```python
# app/controllers/member_controller.py
class MemberController:
    def __init__(self, db_service, current_user):
        self.db_service = db_service
        self.current_user = current_user
    
    def get_all_members(self):
        # ุงูุญุตูู ุนูู ุงูุฃุนุถุงุก ูุน ูุฑุงุนุงุฉ ุงููุชุฑุฉ ุงูุฒูููุฉ ูููุณุชุฎุฏู
        if self.current_user.is_admin:
            # ุงููุฏูุฑ ููููู ุฑุคูุฉ ุฌููุน ุงูุฃุนุถุงุก
            return self.db_service.get_all_members()
        else:
            # ุงูููุธููู ูุฑูู ููุท ุงูุฃุนุถุงุก ูู ูุชุฑุชูู
            time_period = self.current_user.time_period
            if time_period == "men":
                return self.db_service.get_members_by_gender("male")
            elif time_period == "women":
                return self.db_service.get_members_by_gender("female")
            else:
                return self.db_service.get_all_members()
```

#### 1.6 ุชุนุฏูู ููุงุฐุฌ ุงูุจูุงูุงุช ููุชุญูู ูู ุตูุงุญูุงุช ุงููุตูู

```python
# app/models/user.py
class User:
    def __init__(self, id, username, password_hash, name, role, gender, time_period=None, last_login=None):
        self.id = id
        self.username = username
        self.password_hash = password_hash
        self.name = name
        self.role = role
        self.gender = gender  # "male" ุฃู "female"
        self.time_period = time_period  # "men" ุฃู "women" ุฃู "both"
        self.last_login = last_login
        
    @property
    def is_admin(self):
        return self.role == "admin"
    
    def has_time_period_access(self, member):
        """ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุณุชุฎุฏู ูููุตูู ุฅูู ุจูุงูุงุช ุนุถู ูุนูู ุจูุงุกู ุนูู ุงูุฌูุณ ูุงููุชุฑุฉ"""
        if self.is_admin:
            # ุงููุฏูุฑ ูุฏูู ูุตูู ูุงูู
            return True
        
        if self.time_period == "both":
            # ูุชุฑุฉ ูุดุชุฑูุฉ ุชุณูุญ ุจุงููุตูู ุฅูู ุฌููุน ุงูุฃุนุถุงุก
            return True
        
        if self.time_period == "men" and member.gender == "male":
            # ูุชุฑุฉ ุงูุฑุฌุงู ุชุณูุญ ุจุงููุตูู ุฅูู ุงูุฃุนุถุงุก ุงูุฐููุฑ ููุท
            return True
        
        if self.time_period == "women" and member.gender == "female":
            # ูุชุฑุฉ ุงูุณูุฏุงุช ุชุณูุญ ุจุงููุตูู ุฅูู ุงูุฃุนุถุงุก ุงูุฅูุงุซ ููุท
            return True
        
        return False
```

#### 1.7 ุชุนุฏูู ูุธุงู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู

```python
# app/controllers/attendance_controller.py
class AttendanceController:
    def __init__(self, db_service, current_user):
        self.db_service = db_service
        self.current_user = current_user
    
    def check_in_member(self, member_id):
        # ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุตูู ูุจู ุชุณุฌูู ุงูุญุถูุฑ
        member = self.db_service.get_member_by_id(member_id)
        if not member or not self.current_user.has_time_period_access(member):
            return {"success": False, "error": "ููุณ ูุฏูู ุตูุงุญูุฉ ูููุตูู ุฅูู ูุฐุง ุงูุนุถู"}
        
        # ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ุชุณุฌูู ุญุถูุฑ ููุชูุญ
        if self.db_service.has_open_attendance(member_id):
            return {"success": False, "error": "ุงูุนุถู ูุณุฌู ุญุถูุฑ ุจุงููุนู"}
        
        # ุชุณุฌูู ุงูุญุถูุฑ

### 2. ูุธุงู ุฅุนุฏุงุฏุงุช ุงูุฌูู

ูุนุชุจุฑ ูุธุงู ุฅุนุฏุงุฏุงุช ุงูุฌูู ูู ุงูููููุงุช ุงูุฃุณุงุณูุฉ ูู ุงููุธุงูุ ุญูุซ ูุชูุญ ุชุฎุตูุต ูุนูููุงุช ุงููุงุฏู ุงูุฑูุงุถู ูุนุฑุถูุง ูู ุฌููุน ุฃูุญุงุก ุงูุชุทุจูู. ูููุง ููู ุชูุงุตูู ุชูููุฐ ูุฐู ุงูููุฒุฉ ูู ุชุทุจูู ุณุทุญ ุงูููุชุจ:

#### 2.1 ูููุฐุฌ ุงูุจูุงูุงุช ูุงูุชุนุฑููุงุช

```python
# app/models/gym_settings.py
class GymSettings:
    def __init__(self, id=None, gym_name="ูุงุฏู ุงูููุงูุฉ ุงูุจุฏููุฉ", gym_logo=None, address=None, 
                 phone=None, email=None, website=None, working_hours=None, 
                 male_hours=None, female_hours=None, currency="EGP", 
                 invoice_header=None, invoice_footer=None, 
                 primary_color="#4e73df", secondary_color="#1cc88a"):
        self.id = id
        self.gym_name = gym_name
        self.gym_logo = gym_logo  # ูุณุงุฑ ููู ุงูููุฌู
        self.address = address
        self.phone = phone
        self.email = email
        self.website = website
        self.working_hours = working_hours
        self.male_hours = male_hours
        self.female_hours = female_hours
        self.currency = currency
        self.invoice_header = invoice_header
        self.invoice_footer = invoice_footer
        self.primary_color = primary_color
        self.secondary_color = secondary_color
        self.created_at = None
        self.updated_at = None
    
    @property
    def has_logo(self):
        """ุงูุชุญูู ูู ูุฌูุฏ ููุฌู"""
        return self.gym_logo is not None and self.gym_logo.strip() != ''
    
    @property
    def logo_path(self):
        """ุงูุญุตูู ุนูู ุงููุณุงุฑ ุงููุงูู ูููุฌู"""
        if self.has_logo:
            return os.path.join("assets", "logos", self.gym_logo)
        return None
```

#### 2.2 ุฎุฏูุฉ ุฅุนุฏุงุฏุงุช ุงูุฌูู

```python
# app/services/gym_settings_service.py
import os
import shutil
from datetime import datetime
from PIL import Image

class GymSettingsService:
    def __init__(self, db_service):
        self.db_service = db_service
        self.settings = None
        self._load_settings()
    
    def _load_settings(self):
        """ุชุญููู ุฅุนุฏุงุฏุงุช ุงูุฌูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
        self.settings = self.db_service.get_gym_settings()
        if not self.settings:
            # ุฅูุดุงุก ุฅุนุฏุงุฏุงุช ุงูุชุฑุงุถูุฉ ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
            self.settings = self.db_service.create_gym_settings()
    
    def get_settings(self):
        """ุงูุญุตูู ุนูู ุฅุนุฏุงุฏุงุช ุงูุฌูู"""
        return self.settings
    
    def update_settings(self, **kwargs):
        """ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุฌูู"""
        for key, value in kwargs.items():
            if hasattr(self.settings, key):
                setattr(self.settings, key, value)
        
        self.settings.updated_at = datetime.now()
        self.db_service.update_gym_settings(self.settings)
        return self.settings
    
    def upload_logo(self, logo_path):
        """ุชุญููู ุดุนุงุฑ ุงูุฌูู"""
        if not logo_path or not os.path.exists(logo_path):
            return False
        
        # ุฅูุดุงุก ูุฌูุฏ ุงูููุฌู ุฅุฐุง ูู ููู ููุฌูุฏูุง
        logos_dir = os.path.join("assets", "logos")
        os.makedirs(logos_dir, exist_ok=True)
        
        # ุชูููุฏ ุงุณู ููู ูุฑูุฏ ูููุฌู
        file_ext = os.path.splitext(logo_path)[1]
        new_logo_name = f"gym_logo_{datetime.now().strftime('%Y%m%d%H%M%S')}{file_ext}"
        new_logo_path = os.path.join(logos_dir, new_logo_name)
        
        try:
            # ูุณุฎ ุงูููู ุฅูู ูุฌูุฏ ุงูููุฌู
            shutil.copy2(logo_path, new_logo_path)
            
            # ุชุญุฏูุซ ูุณุงุฑ ุงูููุฌู ูู ุงูุฅุนุฏุงุฏุงุช
            self.update_settings(gym_logo=new_logo_name)
            return True
        except Exception as e:
            print(f"ุฎุทุฃ ูู ุชุญููู ุงูููุฌู: {e}")
            return False
    
    def remove_logo(self):
        """ุฅุฒุงูุฉ ุดุนุงุฑ ุงูุฌูู"""
        if self.settings.has_logo:
            logo_path = self.settings.logo_path
            if os.path.exists(logo_path):
                try:
                    os.remove(logo_path)
                except Exception as e:
                    print(f"ุฎุทุฃ ูู ุญุฐู ููู ุงูููุฌู: {e}")
            
            # ุชุญุฏูุซ ุงูุฅุนุฏุงุฏุงุช ูุฅุฒุงูุฉ ูุณุงุฑ ุงูููุฌู
            self.update_settings(gym_logo=None)
            return True
        return False
```

#### 2.3 ูุงุฌูุฉ ุฅุนุฏุงุฏุงุช ุงูุฌูู

```python
# app/views/settings/gym_settings_window.py
import customtkinter as ctk
from tkinter import filedialog, messagebox
from PIL import Image, ImageTk
import os

class GymSettingsWindow(ctk.CTkToplevel):
    def __init__(self, parent, gym_settings_service):
        super().__init__(parent)
        self.gym_settings_service = gym_settings_service
        self.settings = gym_settings_service.get_settings()
        
        self.title("ุฅุนุฏุงุฏุงุช ุงููุงุฏู ุงูุฑูุงุถู")
        self.geometry("800x600")
        self.resizable(True, True)
        
        # ุฅูุดุงุก ุงูุฅุทุงุฑ ุงูุฑุฆูุณู
        self.main_frame = ctk.CTkFrame(self)
        self.main_frame.pack(fill="both", expand=True, padx=20, pady=20)
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self._create_widgets()
        
        # ุชุญููู ุงูุจูุงูุงุช ุงูุญุงููุฉ
        self._load_current_settings()
    
    def _create_widgets(self):
        """ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู"""
        # ุฅูุดุงุก ุฅุทุงุฑ ุงููุนูููุงุช ุงูุฃุณุงุณูุฉ
        self.basic_info_frame = ctk.CTkFrame(self.main_frame)
        self.basic_info_frame.pack(fill="x", padx=10, pady=10)
        
        # ุนููุงู ุงููุณู
        self.basic_info_label = ctk.CTkLabel(self.basic_info_frame, text="ูุนูููุงุช ุงููุงุฏู ุงูุฃุณุงุณูุฉ", font=ctk.CTkFont(size=16, weight="bold"))
        self.basic_info_label.pack(pady=10)
        
        # ุงุณู ุงููุงุฏู
        self.gym_name_label = ctk.CTkLabel(self.basic_info_frame, text="ุงุณู ุงููุงุฏู:")
        self.gym_name_label.pack(anchor="w", padx=10, pady=(10, 5))
        
        self.gym_name_entry = ctk.CTkEntry(self.basic_info_frame, width=400)
        self.gym_name_entry.pack(anchor="w", padx=10, pady=(0, 10))
        
        # ุงูุนููุงู
        self.address_label = ctk.CTkLabel(self.basic_info_frame, text="ุงูุนููุงู:")
        self.address_label.pack(anchor="w", padx=10, pady=(10, 5))
        
        self.address_entry = ctk.CTkTextbox(self.basic_info_frame, width=400, height=60)
        self.address_entry.pack(anchor="w", padx=10, pady=(0, 10))
        
        # ุฑูู ุงููุงุชู
        self.phone_label = ctk.CTkLabel(self.basic_info_frame, text="ุฑูู ุงููุงุชู:")
        self.phone_label.pack(anchor="w", padx=10, pady=(10, 5))
        
        self.phone_entry = ctk.CTkEntry(self.basic_info_frame, width=400)
        self.phone_entry.pack(anchor="w", padx=10, pady=(0, 10))
        
        # ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
        self.email_label = ctk.CTkLabel(self.basic_info_frame, text="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:")
        self.email_label.pack(anchor="w", padx=10, pady=(10, 5))
        
        self.email_entry = ctk.CTkEntry(self.basic_info_frame, width=400)
        self.email_entry.pack(anchor="w", padx=10, pady=(0, 10))
        
        # ุงููููุน ุงูุฅููุชุฑููู
        self.website_label = ctk.CTkLabel(self.basic_info_frame, text="ุงููููุน ุงูุฅููุชุฑููู:")
        self.website_label.pack(anchor="w", padx=10, pady=(10, 5))
        
        self.website_entry = ctk.CTkEntry(self.basic_info_frame, width=400)
        self.website_entry.pack(anchor="w", padx=10, pady=(0, 10))
        
        # ุฅูุดุงุก ุฅุทุงุฑ ุงูููุฌู
        self.logo_frame = ctk.CTkFrame(self.main_frame)
        self.logo_frame.pack(fill="x", padx=10, pady=10)
        
        # ุนููุงู ูุณู ุงูููุฌู
        self.logo_label = ctk.CTkLabel(self.logo_frame, text="ุดุนุงุฑ ุงููุงุฏู", font=ctk.CTkFont(size=16, weight="bold"))
        self.logo_label.pack(pady=10)
        
        # ุนุฑุถ ุงูููุฌู ุงูุญุงูู
        self.logo_preview_frame = ctk.CTkFrame(self.logo_frame, width=200, height=200)
        self.logo_preview_frame.pack(pady=10)
        
        self.logo_preview = ctk.CTkLabel(self.logo_preview_frame, text="ูุง ููุฌุฏ ุดุนุงุฑ")
        self.logo_preview.pack(expand=True, fill="both")
        
        # ุฃุฒุฑุงุฑ ุชุญููู ูุญุฐู ุงูููุฌู
        self.logo_buttons_frame = ctk.CTkFrame(self.logo_frame)
        self.logo_buttons_frame.pack(pady=10)
        
        self.upload_logo_button = ctk.CTkButton(self.logo_buttons_frame, text="ุชุญููู ุดุนุงุฑ", command=self._upload_logo)
        self.upload_logo_button.pack(side="left", padx=5)
        
        self.remove_logo_button = ctk.CTkButton(self.logo_buttons_frame, text="ุญุฐู ุงูุดุนุงุฑ", command=self._remove_logo, fg_color="#E74A3B")
        self.remove_logo_button.pack(side="left", padx=5)
        
        # ุฅูุดุงุก ุฅุทุงุฑ ุฃุฒุฑุงุฑ ุงูุญูุธ ูุงูุฅูุบุงุก
        self.buttons_frame = ctk.CTkFrame(self.main_frame)
        self.buttons_frame.pack(fill="x", padx=10, pady=20)
        
        self.save_button = ctk.CTkButton(self.buttons_frame, text="ุญูุธ ุงูุชุบููุฑุงุช", command=self._save_settings)
        self.save_button.pack(side="right", padx=10)
        
        self.cancel_button = ctk.CTkButton(self.buttons_frame, text="ุฅูุบุงุก", command=self.destroy, fg_color="#858796")
        self.cancel_button.pack(side="right", padx=10)
    
    def _load_current_settings(self):
        """ุชุญููู ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ"""
        if self.settings:
            self.gym_name_entry.insert(0, self.settings.gym_name or "")
            if self.settings.address:
                self.address_entry.insert("1.0", self.settings.address)
            self.phone_entry.insert(0, self.settings.phone or "")
            self.email_entry.insert(0, self.settings.email or "")
            self.website_entry.insert(0, self.settings.website or "")
            
            # ุนุฑุถ ุงูููุฌู ุฅุฐุง ูุงู ููุฌูุฏูุง
            self._display_logo()
    
    def _display_logo(self):
        """ุนุฑุถ ุงูููุฌู ุงูุญุงูู"""
        if self.settings.has_logo and os.path.exists(self.settings.logo_path):
            try:
                # ูุชุญ ูุชุบููุฑ ุญุฌู ุงูุตูุฑุฉ
                logo_img = Image.open(self.settings.logo_path)
                logo_img = logo_img.resize((180, 180), Image.LANCZOS)
                
                # ุชุญููู ุงูุตูุฑุฉ ุฅูู ุตูุบุฉ ูุชูุงููุฉ ูุน Tkinter
                self.logo_tk_img = ImageTk.PhotoImage(logo_img)
                
                # ุนุฑุถ ุงูุตูุฑุฉ
                self.logo_preview.configure(image=self.logo_tk_img, text="")
            except Exception as e:
                print(f"ุฎุทุฃ ูู ุนุฑุถ ุงูููุฌู: {e}")
                self.logo_preview.configure(text="ุฎุทุฃ ูู ุนุฑุถ ุงูุดุนุงุฑ")
        else:
            self.logo_preview.configure(text="ูุง ููุฌุฏ ุดุนุงุฑ", image=None)
    
    def _upload_logo(self):
        """ุชุญููู ุดุนุงุฑ ุฌุฏูุฏ"""
        file_path = filedialog.askopenfilename(
            title="ุงุฎุชุฑ ุดุนุงุฑ ุงููุงุฏู",
            filetypes=[("ุตูุฑ", "*.png *.jpg *.jpeg *.gif *.bmp")]
        )
        
        if file_path:
            success = self.gym_settings_service.upload_logo(file_path)
            if success:
                messagebox.showinfo("ุชู", "ุชู ุชุญููู ุงูุดุนุงุฑ ุจูุฌุงุญ")
                # ุชุญุฏูุซ ุงูุฅุนุฏุงุฏุงุช ูุนุฑุถ ุงูููุฌู ุงูุฌุฏูุฏ
                self.settings = self.gym_settings_service.get_settings()
                self._display_logo()
            else:
                messagebox.showerror("ุฎุทุฃ", "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุงูุดุนุงุฑ")
    
    def _remove_logo(self):
        """ุญุฐู ุงูุดุนุงุฑ ุงูุญุงูู"""
        if not self.settings.has_logo:
            messagebox.showinfo("ุชูุจูู", "ูุง ููุฌุฏ ุดุนุงุฑ ูุญุฐูู")
            return
        
        if messagebox.askyesno("ุชุฃููุฏ", "ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุงูุดุนุงุฑ ุงูุญุงููุ"):
            success = self.gym_settings_service.remove_logo()
            if success:
                messagebox.showinfo("ุชู", "ุชู ุญุฐู ุงูุดุนุงุฑ ุจูุฌุงุญ")
                # ุชุญุฏูุซ ุงูุฅุนุฏุงุฏุงุช ูุนุฑุถ ุญุงูุฉ ุนุฏู ูุฌูุฏ ููุฌู
                self.settings = self.gym_settings_service.get_settings()
                self._display_logo()
            else:
                messagebox.showerror("ุฎุทุฃ", "ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุดุนุงุฑ")
    
    def _save_settings(self):
        """ุญูุธ ุงูุชุบููุฑุงุช"""
        # ุฌูุน ุงูุจูุงูุงุช ูู ุญููู ุงูุฅุฏุฎุงู
        gym_name = self.gym_name_entry.get()
        address = self.address_entry.get("1.0", "end-1c")
        phone = self.phone_entry.get()
        email = self.email_entry.get()
        website = self.website_entry.get()
        
        # ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
        if not gym_name:
            messagebox.showerror("ุฎุทุฃ", "ูุฌุจ ุฅุฏุฎุงู ุงุณู ุงููุงุฏู")
            return
        
        # ุชุญุฏูุซ ุงูุฅุนุฏุงุฏุงุช
        self.gym_settings_service.update_settings(
            gym_name=gym_name,
            address=address,
            phone=phone,
            email=email,
            website=website
        )
        
        messagebox.showinfo("ุชู", "ุชู ุญูุธ ุงูุฅุนุฏุงุฏุงุช ุจูุฌุงุญ")
        self.destroy()
```

#### 2.4 ุชูุงูู ุฅุนุฏุงุฏุงุช ุงูุฌูู ูุน ุงููุธุงู

##### 2.4.1 ุนุฑุถ ูุนูููุงุช ุงูุฌูู ูู ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ

```python
# app/views/main_window.py
class MainWindow(ctk.CTk):
    def __init__(self, auth_controller, gym_settings_service):
        super().__init__()
        self.auth_controller = auth_controller
        self.gym_settings_service = gym_settings_service
        self.current_user = None
        self.settings = gym_settings_service.get_settings()
        
        # ... ุงูููุฏ ุงูุญุงูู ...
        
    def show_main_window(self, user):
        self.current_user = user
        
        # ุฅูุดุงุก ุงูุดุฑูุท ุงูุนููู ูุน ูุนูููุงุช ุงููุณุชุฎุฏู ูุงููุชุฑุฉ ููุนูููุงุช ุงูุฌูู
        self.header_frame = ctk.CTkFrame(self)
        self.header_frame.pack(fill="x", padx=10, pady=5)
        
        # ุนุฑุถ ุดุนุงุฑ ุงูุฌูู ุฅุฐุง ูุงู ููุฌูุฏูุง
        if self.settings.has_logo and os.path.exists(self.settings.logo_path):
            try:
                logo_img = Image.open(self.settings.logo_path)
                logo_img = logo_img.resize((40, 40), Image.LANCZOS)
                self.logo_tk_img = ImageTk.PhotoImage(logo_img)
                
                self.logo_label = ctk.CTkLabel(self.header_frame, image=self.logo_tk_img, text="")
                self.logo_label.pack(side="left", padx=10)
            except Exception as e:
                print(f"ุฎุทุฃ ูู ุนุฑุถ ุงูููุฌู: {e}")
        
        # ุนุฑุถ ุงุณู ุงูุฌูู
        self.gym_name_label = ctk.CTkLabel(self.header_frame, text=self.settings.gym_name, font=ctk.CTkFont(size=16, weight="bold"))
        self.gym_name_label.pack(side="left", padx=10)
        
        # ุนุฑุถ ุงุณู ุงููุณุชุฎุฏู ูุงููุชุฑุฉ ุงูุญุงููุฉ
        period_text = "ูุชุฑุฉ ุงูุฑุฌุงู" if user.time_period == "men" else "ูุชุฑุฉ ุงูุณูุฏุงุช" if user.time_period == "women" else "ุฌููุน ุงููุชุฑุงุช"
        self.user_label = ctk.CTkLabel(self.header_frame, text=f"ูุฑุญุจุงู {user.name} | {period_text}")
        self.user_label.pack(side="right", padx=10)
        
        # ... ุจุงูู ุงูููุฏ ...
```

##### 2.4.2 ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ุงูุฌูู ูู ุงูููุงุชูุฑ

```python
# app/services/invoice_service.py
class InvoiceService:
    def __init__(self, db_service, gym_settings_service):
        self.db_service = db_service
        self.gym_settings_service = gym_settings_service
    
    def generate_invoice(self, payment_id):
        """ุฅูุดุงุก ูุงุชูุฑุฉ PDF"""
        payment = self.db_service.get_payment_by_id(payment_id)
        if not payment:
            return None
        
        # ุงูุญุตูู ุนูู ุฅุนุฏุงุฏุงุช ุงูุฌูู
        gym_settings = self.gym_settings_service.get_settings()
        
        # ุฅูุดุงุก ููู PDF
        buffer = BytesIO()
        doc = SimpleDocTemplate(buffer, pagesize=A4, rightMargin=30, leftMargin=30, topMargin=30, bottomMargin=30)
        story = []
        
        # ุฅุถุงูุฉ ุฑุฃุณ ุงููุงุชูุฑุฉ ูุน ูุนูููุงุช ุงูุฌูู
        self._add_invoice_header(story, gym_settings, payment)
        
        # ... ุจุงูู ููุฏ ุฅูุดุงุก ุงููุงุชูุฑุฉ ...
        
        return buffer
    
    def _add_invoice_header(self, story, gym_settings, payment):
        """ุฅุถุงูุฉ ุฑุฃุณ ุงููุงุชูุฑุฉ ูุน ูุนูููุงุช ุงูุฌูู"""
        # ุฅุถุงูุฉ ุดุนุงุฑ ุงูุฌูู ุฅุฐุง ูุงู ููุฌูุฏูุง
        if gym_settings.has_logo and os.path.exists(gym_settings.logo_path):
            logo_img = Image(gym_settings.logo_path, width=100, height=100)
            story.append(logo_img)
        
        # ุฅุถุงูุฉ ุงุณู ุงูุฌูู
        styles = getSampleStyleSheet()
        gym_name_style = ParagraphStyle(
            'GymName',
            parent=styles['Title'],
            fontSize=20,
            alignment=1,  # ูุณุท
            spaceAfter=10
        )
        story.append(Paragraph(gym_settings.gym_name, gym_name_style))
        
        # ุฅุถุงูุฉ ูุนูููุงุช ุงูุงุชุตุงู
        contact_info = []
        if gym_settings.address:
            contact_info.append(gym_settings.address)
        if gym_settings.phone:
            contact_info.append(f"ูุงุชู: {gym_settings.phone}")
        if gym_settings.email:
            contact_info.append(f"ุจุฑูุฏ ุฅููุชุฑููู: {gym_settings.email}")
        
        contact_style = ParagraphStyle(
            'ContactInfo',
            parent=styles['Normal'],
            fontSize=10,
            alignment=1,  # ูุณุท
            spaceAfter=20
        )
        
        for info in contact_info:
            story.append(Paragraph(info, contact_style))
        
        # ุฅุถุงูุฉ ุนููุงู ุงููุงุชูุฑุฉ
        invoice_title_style = ParagraphStyle(
            'InvoiceTitle',
            parent=styles['Heading1'],
            fontSize=16,
            alignment=1,  # ูุณุท
            spaceAfter=20
        )
        story.append(Paragraph("ูุงุชูุฑุฉ ุฏูุน", invoice_title_style))
        
        # ... ุจุงูู ููุฏ ุฑุฃุณ ุงููุงุชูุฑุฉ ...
```

##### 2.4.3 ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ุงูุฌูู ูู ุจุทุงูุงุช ุงูุนุถููุฉ

```python
# app/services/membership_card_service.py
class MembershipCardService:
    def __init__(self, db_service, gym_settings_service):
        self.db_service = db_service
        self.gym_settings_service = gym_settings_service
    
    def generate_membership_card(self, member_id):
        """ุฅูุดุงุก ุจุทุงูุฉ ุนุถููุฉ"""
        member = self.db_service.get_member_by_id(member_id)
        if not member:
            return None
        
        # ุงูุญุตูู ุนูู ุฅุนุฏุงุฏุงุช ุงูุฌูู
        gym_settings = self.gym_settings_service.get_settings()
        
        # ุฅูุดุงุก ุตูุฑุฉ ุงูุจุทุงูุฉ
        card_img = Image.new('RGB', (600, 350), color='white')
        draw = ImageDraw.Draw(card_img)
        
        # ุฅุถุงูุฉ ุดุนุงุฑ ุงูุฌูู ุฅุฐุง ูุงู ููุฌูุฏูุง
        if gym_settings.has_logo and os.path.exists(gym_settings.logo_path):
            try:
                logo_img = Image.open(gym_settings.logo_path)
                logo_img = logo_img.resize((80, 80), Image.LANCZOS)
                card_img.paste(logo_img, (20, 20))
            except Exception as e:
                print(f"ุฎุทุฃ ูู ุฅุถุงูุฉ ุงูููุฌู ููุจุทุงูุฉ: {e}")
        
        # ุฅุถุงูุฉ ุงุณู ุงูุฌูู ููุนูููุงุช ุงูุงุชุตุงู
        font_path = os.path.join("assets", "fonts", "Cairo-Bold.ttf")
        title_font = ImageFont.truetype(font_path, 24)
        info_font = ImageFont.truetype(font_path, 14)
        
        draw.text((120, 30), gym_settings.gym_name, font=title_font, fill='#000000')
        
        y_pos = 60
        if gym_settings.address:
            draw.text((120, y_pos), gym_settings.address, font=info_font, fill='#444444')
            y_pos += 20
        if gym_settings.phone:
            draw.text((120, y_pos), f"ูุงุชู: {gym_settings.phone}", font=info_font, fill='#444444')
            y_pos += 20
        
        # ... ุจุงูู ููุฏ ุฅูุดุงุก ุงูุจุทุงูุฉ ...
        
        return card_img
```

##### 2.4.4 ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ุงูุฌูู ูู ุงูุชูุงุฑูุฑ

```python
# app/services/report_service.py
class ReportService:
    def __init__(self, db_service, gym_settings_service):
        self.db_service = db_service
        self.gym_settings_service = gym_settings_service
    
    def generate_members_report(self, filters=None):
        """ุฅูุดุงุก ุชูุฑูุฑ ุงูุฃุนุถุงุก"""
        members = self.db_service.get_members(filters)
        
        # ุงูุญุตูู ุนูู ุฅุนุฏุงุฏุงุช ุงูุฌูู
        gym_settings = self.gym_settings_service.get_settings()
        
        # ุฅูุดุงุก ููู PDF
        buffer = BytesIO()
        doc = SimpleDocTemplate(buffer, pagesize=A4, rightMargin=30, leftMargin=30, topMargin=30, bottomMargin=30)
        story = []
        
        # ุฅุถุงูุฉ ุฑุฃุณ ุงูุชูุฑูุฑ ูุน ูุนูููุงุช ุงูุฌูู
        self._add_report_header(story, gym_settings, "ุชูุฑูุฑ ุงูุฃุนุถุงุก")
        
        # ... ุจุงูู ููุฏ ุฅูุดุงุก ุงูุชูุฑูุฑ ...
        
        return buffer
    
    def _add_report_header(self, story, gym_settings, report_title):
        """ุฅุถุงูุฉ ุฑุฃุณ ุงูุชูุฑูุฑ ูุน ูุนูููุงุช ุงูุฌูู"""
        # ุฅุถุงูุฉ ุดุนุงุฑ ุงูุฌูู ุฅุฐุง ูุงู ููุฌูุฏูุง
        if gym_settings.has_logo and os.path.exists(gym_settings.logo_path):
            logo_img = Image(gym_settings.logo_path, width=100, height=100)
            story.append(logo_img)
        
        # ุฅุถุงูุฉ ุงุณู ุงูุฌูู
        styles = getSampleStyleSheet()
        gym_name_style = ParagraphStyle(
            'GymName',
            parent=styles['Title'],
            fontSize=20,
            alignment=1,  # ูุณุท
            spaceAfter=10
        )
        story.append(Paragraph(gym_settings.gym_name, gym_name_style))
        
        # ุฅุถุงูุฉ ุนููุงู ุงูุชูุฑูุฑ
        report_title_style = ParagraphStyle(
            'ReportTitle',
            parent=styles['Heading1'],
            fontSize=16,
            alignment=1,  # ูุณุท
            spaceAfter=20
        )
        story.append(Paragraph(report_title, report_title_style))
        
        # ุฅุถุงูุฉ ุชุงุฑูุฎ ุงูุชูุฑูุฑ
        date_style = ParagraphStyle(
            'ReportDate',
            parent=styles['Normal'],
            fontSize=10,
            alignment=1,  # ูุณุท
            spaceAfter=20
        )
        report_date = datetime.now().strftime("%Y-%m-%d %H:%M")
        story.append(Paragraph(f"ุชุงุฑูุฎ ุงูุชูุฑูุฑ: {report_date}", date_style))
        
        # ... ุจุงูู ููุฏ ุฑุฃุณ ุงูุชูุฑูุฑ ...
```

#### 2.5 ุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช ุงูุฌูู ุฅูู ูุงุฆูุฉ ุงูุฅุนุฏุงุฏุงุช

```python
# app/views/settings/settings_menu.py
class SettingsMenu(ctk.CTkFrame):
    def __init__(self, parent, controllers):
        super().__init__(parent)
        self.parent = parent
        self.controllers = controllers
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self._create_widgets()
    
    def _create_widgets(self):
        """ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู"""
        # ุนููุงู ุงููุณู
        self.title_label = ctk.CTkLabel(self, text="ุฅุนุฏุงุฏุงุช ุงููุธุงู", font=ctk.CTkFont(size=20, weight="bold"))
        self.title_label.pack(pady=20)
        
        # ุฅูุดุงุก ุฃุฒุฑุงุฑ ุงูุฅุนุฏุงุฏุงุช
        self.buttons_frame = ctk.CTkFrame(self)
        self.buttons_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        # ุฒุฑ ุฅุนุฏุงุฏุงุช ุงูุฌูู
        self.gym_settings_button = ctk.CTkButton(
            self.buttons_frame,
            text="ุฅุนุฏุงุฏุงุช ุงููุงุฏู ุงูุฑูุงุถู",
            command=self._open_gym_settings,
            height=50,
            font=ctk.CTkFont(size=14)
        )
        self.gym_settings_button.pack(fill="x", pady=10)
        
        # ุฒุฑ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
        self.users_button = ctk.CTkButton(
            self.buttons_frame,
            text="ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู",
            command=self._open_users_settings,
            height=50,
            font=ctk.CTkFont(size=14)
        )
        self.users_button.pack(fill="x", pady=10)
        
        # ... ุฃุฒุฑุงุฑ ุฅุนุฏุงุฏุงุช ุฃุฎุฑู ...
    
    def _open_gym_settings(self):
        """ูุชุญ ูุงูุฐุฉ ุฅุนุฏุงุฏุงุช ุงูุฌูู"""
        from app.views.settings.gym_settings_window import GymSettingsWindow
        gym_settings_window = GymSettingsWindow(self.parent, self.controllers["gym_settings_service"])
        gym_settings_window.grab_set()  # ุฌุนู ุงููุงูุฐุฉ ูุฑูุฒ ุงูุงูุชูุงู
    
    def _open_users_settings(self):
        """ูุชุญ ูุงูุฐุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู"""
        # ... ููุฏ ูุชุญ ูุงูุฐุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ...
```

#### 2.6 ููุฎุต ุชูููุฐ ูุธุงู ุฅุนุฏุงุฏุงุช ุงูุฌูู

ูุชู ุชูููุฐ ูุธุงู ุฅุนุฏุงุฏุงุช ุงูุฌูู ูู ุชุทุจูู ุณุทุญ ุงูููุชุจ ุจุงูุทุฑููุฉ ุงูุชุงููุฉ:

1. **ูููุฐุฌ ุงูุจูุงูุงุช**: ุชู ุฅูุดุงุก ูููุฐุฌ `GymSettings` ูุชุฎุฒูู ูุนูููุงุช ุงูุฌูู ุงูุฃุณุงุณูุฉ ูุซู ุงูุงุณู ูุงูููุฌู ููุนูููุงุช ุงูุงุชุตุงู.

2. **ุฎุฏูุฉ ุฅุนุฏุงุฏุงุช ุงูุฌูู**: ุชู ุฅูุดุงุก ุฎุฏูุฉ `GymSettingsService` ููุชุนุงูู ูุน ุฅุนุฏุงุฏุงุช ุงูุฌููุ ุจูุง ูู ุฐูู ุชุญููู ุงูุฅุนุฏุงุฏุงุช ูุชุญุฏูุซูุง ูุฅุฏุงุฑุฉ ุดุนุงุฑ ุงูุฌูู.

3. **ูุงุฌูุฉ ุฅุนุฏุงุฏุงุช ุงูุฌูู**: ุชู ุฅูุดุงุก ูุงูุฐุฉ `GymSettingsWindow` ูุชูููู ุงููุณุชุฎุฏููู ูู ุชุนุฏูู ุฅุนุฏุงุฏุงุช ุงูุฌูู ุจุณูููุฉ.

4. **ุชูุงูู ูุน ุงููุธุงู**: ุชู ุฏูุฌ ุฅุนุฏุงุฏุงุช ุงูุฌูู ูู ุฌููุน ุฃูุญุงุก ุงููุธุงูุ ุจูุง ูู ุฐูู:
   - ุนุฑุถ ูุนูููุงุช ุงูุฌูู ูู ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
   - ุงุณุชุฎุฏุงู ูุนูููุงุช ุงูุฌูู ูู ุงูููุงุชูุฑ
   - ุงุณุชุฎุฏุงู ูุนูููุงุช ุงูุฌูู ูู ุจุทุงูุงุช ุงูุนุถููุฉ
   - ุงุณุชุฎุฏุงู ูุนูููุงุช ุงูุฌูู ูู ุงูุชูุงุฑูุฑ

5. **ุฅุถุงูุฉ ุฅูู ูุงุฆูุฉ ุงูุฅุนุฏุงุฏุงุช**: ุชู ุฅุถุงูุฉ ุฎูุงุฑ ุฅุนุฏุงุฏุงุช ุงูุฌูู ุฅูู ูุงุฆูุฉ ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ ูููุธุงู.

ูุฐุง ุงูุชูููุฐ ูุถูู ุฃู ูุนูููุงุช ุงูุฌูู ุชุธูุฑ ุจุดูู ูุชุณู ูู ุฌููุน ุฃูุญุงุก ุงูุชุทุจููุ ููุง ูุนุฒุฒ ุงููููุฉ ุงูุจุตุฑูุฉ ูููุงุฏู ุงูุฑูุงุถู ููููุฑ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุชูุงููุฉ.
        attendance = Attendance(
            member_id=member_id,
            check_in_time=datetime.now(),
            check_in_by=self.current_user.id,
            time_period=self.current_user.time_period
        )
        
        self.db_service.add_attendance(attendance)
        return {"success": True, "attendance": attendance}
```

#### 1.8 ุชุนุฏูู ูุธุงู ุงูุชูุงุฑูุฑ

```python
# app/controllers/report_controller.py
class ReportController:
    def __init__(self, db_service, current_user):
        self.db_service = db_service
        self.current_user = current_user
    
    def generate_financial_report(self, start_date, end_date, detail_level="summary"):
        # ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู
        if not self.current_user.is_admin and not self.current_user.role == "accountant":
            return {"success": False, "error": "ููุณ ูุฏูู ุตูุงุญูุฉ ูููุตูู ุฅูู ุงูุชูุงุฑูุฑ ุงููุงููุฉ"}
        
        # ุชุญุฏูุฏ ุงููุชุฑุฉ ุงูุฒูููุฉ ููุชูุฑูุฑ
        time_period = self.current_user.time_period
        
        # ุฌูุน ุงูุจูุงูุงุช ุงููุงููุฉ ูุน ูุฑุงุนุงุฉ ุงููุชุฑุฉ ุงูุฒูููุฉ
        if time_period == "men":
            # ุชูุงุฑูุฑ ูุงููุฉ ููุชุฑุฉ ุงูุฑุฌุงู ููุท
            income = self.db_service.get_income_by_period(start_date, end_date, "men")
            expenses = self.db_service.get_expenses_by_period(start_date, end_date, "men")
        elif time_period == "women":
            # ุชูุงุฑูุฑ ูุงููุฉ ููุชุฑุฉ ุงูุณูุฏุงุช ููุท
            income = self.db_service.get_income_by_period(start_date, end_date, "women")
            expenses = self.db_service.get_expenses_by_period(start_date, end_date, "women")
        else:
            # ุชูุงุฑูุฑ ูุงููุฉ ูุฌููุน ุงููุชุฑุงุช (ูููุฏูุฑ)
            income = self.db_service.get_income(start_date, end_date)
            expenses = self.db_service.get_expenses(start_date, end_date)
        
        # ุญุณุงุจ ุงูุฅุฌูุงููุงุช
        total_income = sum(item.amount for item in income)
        total_expenses = sum(item.amount for item in expenses)
        net_profit = total_income - total_expenses
        
        # ุฅุนุฏุงุฏ ุงูุชูุฑูุฑ
        report = {
            "success": True,
            "start_date": start_date,
            "end_date": end_date,
            "time_period": time_period,
            "total_income": total_income,
            "total_expenses": total_expenses,
            "net_profit": net_profit
        }
        
        # ุฅุถุงูุฉ ุชูุงุตูู ุฅุถุงููุฉ ุญุณุจ ูุณุชูู ุงูุชูุตูู ุงููุทููุจ
        if detail_level == "detailed":
            report["income_by_category"] = self._group_by_category(income)
            report["expenses_by_category"] = self._group_by_category(expenses)
        
        return report
    
    def generate_member_report(self, start_date, end_date):
        # ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู
        if not self.current_user.is_admin and not self.current_user.role in ["manager", "receptionist"]:
            return {"success": False, "error": "ููุณ ูุฏูู ุตูุงุญูุฉ ูููุตูู ุฅูู ุชูุงุฑูุฑ ุงูุฃุนุถุงุก"}
        
        # ุชุญุฏูุฏ ุงููุชุฑุฉ ุงูุฒูููุฉ ููุชูุฑูุฑ
        time_period = self.current_user.time_period
        
        # ุฌูุน ุจูุงูุงุช ุงูุฃุนุถุงุก ูุน ูุฑุงุนุงุฉ ุงููุชุฑุฉ ุงูุฒูููุฉ
        if time_period == "men":
            # ุชูุงุฑูุฑ ุงูุฃุนุถุงุก ููุชุฑุฉ ุงูุฑุฌุงู ููุท
            members = self.db_service.get_members_by_gender("male")
            new_members = self.db_service.get_new_members_by_period(start_date, end_date, "male")
            active_subscriptions = self.db_service.get_active_subscriptions_by_gender("male")
        elif time_period == "women":
            # ุชูุงุฑูุฑ ุงูุฃุนุถุงุก ููุชุฑุฉ ุงูุณูุฏุงุช ููุท
            members = self.db_service.get_members_by_gender("female")
            new_members = self.db_service.get_new_members_by_period(start_date, end_date, "female")
            active_subscriptions = self.db_service.get_active_subscriptions_by_gender("female")
        else:
            # ุชูุงุฑูุฑ ุงูุฃุนุถุงุก ูุฌููุน ุงููุชุฑุงุช (ูููุฏูุฑ)
            members = self.db_service.get_all_members()
            new_members = self.db_service.get_new_members(start_date, end_date)
            active_subscriptions = self.db_service.get_active_subscriptions()
        
        # ุฅุนุฏุงุฏ ุงูุชูุฑูุฑ
        report = {
            "success": True,
            "start_date": start_date,
            "end_date": end_date,
            "time_period": time_period,
            "total_members": len(members),
            "active_members": len([m for m in members if m.status == "active"]),
            "new_members": len(new_members),
            "active_subscriptions": len(active_subscriptions)
        }
        
        return report
```

#### 1.9 ุชุนุฏูู ูุธุงู ุงููุจูุนุงุช ูุงููุฎุฒูู

```python
# app/controllers/inventory_controller.py
class InventoryController:
    def __init__(self, db_service, current_user):
        self.db_service = db_service
        self.current_user = current_user
    
    def sell_product(self, product_id, quantity, member_id=None):
        # ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู
        if not self.current_user.role in ["admin", "sales", "receptionist"]:
            return {"success": False, "error": "ููุณ ูุฏูู ุตูุงุญูุฉ ูุฅุฌุฑุงุก ุนูููุงุช ุงูุจูุน"}
        
        # ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุตูู ููุนุถู ุฅุฐุง ุชู ุชุญุฏูุฏู
        if member_id:
            member = self.db_service.get_member_by_id(member_id)
            if not member or not self.current_user.has_time_period_access(member):
                return {"success": False, "error": "ููุณ ูุฏูู ุตูุงุญูุฉ ูููุตูู ุฅูู ูุฐุง ุงูุนุถู"}
        
        # ุงูุชุญูู ูู ุชููุฑ ุงูููุชุฌ
        product = self.db_service.get_product_by_id(product_id)
        if not product or product.quantity < quantity:
            return {"success": False, "error": "ุงูููุชุฌ ุบูุฑ ูุชููุฑ ุจุงููููุฉ ุงููุทููุจุฉ"}
        
        # ุฅูุดุงุก ุนูููุฉ ุงูุจูุน
        sale = Sale(
            product_id=product_id,
            quantity=quantity,
            price=product.price,
            total=product.price * quantity,
            member_id=member_id,
            sold_by=self.current_user.id,
            sale_date=datetime.now(),
            time_period=self.current_user.time_period
        )
        
        # ุชุญุฏูุซ ุงููุฎุฒูู
        product.quantity -= quantity
        
        # ุญูุธ ุงูุชุบููุฑุงุช
        self.db_service.add_sale(sale)
        self.db_service.update_product(product)
        
        return {"success": True, "sale": sale}
```

#### 1.10 ุชุนุฏูู ูุงุฌูุฉ ุฅุถุงูุฉ ุงูุฃุนุถุงุก

```python
# app/views/member_form_view.py
class MemberFormWindow(ctk.CTkToplevel):
    def __init__(self, parent, member_controller, member=None):
        super().__init__(parent)
        self.member_controller = member_controller
        self.member = member
        self.is_edit_mode = member is not None
        
        self.title("ุชุนุฏูู ุจูุงูุงุช ุนุถู" if self.is_edit_mode else "ุฅุถุงูุฉ ุนุถู ุฌุฏูุฏ")
        self.geometry("600x700")
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.title_label = ctk.CTkLabel(self, text=self.title(), font=ctk.CTkFont(size=20, weight="bold"))
        self.title_label.pack(pady=10)
        
        # ุฅุทุงุฑ ุงููููุฐุฌ
        self.form_frame = ctk.CTkScrollableFrame(self)
        self.form_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        # ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ
        self.personal_info_label = ctk.CTkLabel(self.form_frame, text="ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ", font=ctk.CTkFont(weight="bold"))
        self.personal_info_label.pack(anchor="w", pady=(10, 5))
        
        # ุงูุงุณู ุงูุฃูู
        self.first_name_label = ctk.CTkLabel(self.form_frame, text="ุงูุงุณู ุงูุฃูู:")
        self.first_name_label.pack(anchor="w")
        self.first_name_entry = ctk.CTkEntry(self.form_frame, width=250)
        self.first_name_entry.pack(anchor="w", pady=(0, 10))
        
        # ุงูุงุณู ุงูุฃุฎูุฑ
        self.last_name_label = ctk.CTkLabel(self.form_frame, text="ุงูุงุณู ุงูุฃุฎูุฑ:")
        self.last_name_label.pack(anchor="w")
        self.last_name_entry = ctk.CTkEntry(self.form_frame, width=250)
        self.last_name_entry.pack(anchor="w", pady=(0, 10))
        
        # ุฑูู ุงููุงุชู
        self.phone_label = ctk.CTkLabel(self.form_frame, text="ุฑูู ุงููุงุชู:")
        self.phone_label.pack(anchor="w")
        self.phone_entry = ctk.CTkEntry(self.form_frame, width=250)
        self.phone_entry.pack(anchor="w", pady=(0, 10))
        
        # ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
        self.email_label = ctk.CTkLabel(self.form_frame, text="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:")
        self.email_label.pack(anchor="w")
        self.email_entry = ctk.CTkEntry(self.form_frame, width=250)
        self.email_entry.pack(anchor="w", pady=(0, 10))
        
        # ุชุงุฑูุฎ ุงููููุงุฏ
        self.birth_date_label = ctk.CTkLabel(self.form_frame, text="ุชุงุฑูุฎ ุงููููุงุฏ:")
        self.birth_date_label.pack(anchor="w")
        
        self.birth_date_frame = ctk.CTkFrame(self.form_frame)
        self.birth_date_frame.pack(anchor="w", pady=(0, 10))
        
        # ุงุฎุชูุงุฑ ุงูููู ูุงูุดูุฑ ูุงูุณูุฉ
        self.birth_day = ctk.CTkComboBox(self.birth_date_frame, values=[str(i) for i in range(1, 32)])
        self.birth_day.pack(side="left", padx=5)
        
        self.birth_month = ctk.CTkComboBox(self.birth_date_frame, values=[str(i) for i in range(1, 13)])
        self.birth_month.pack(side="left", padx=5)
        
        self.birth_year = ctk.CTkComboBox(self.birth_date_frame, values=[str(i) for i in range(1950, 2020)])
        self.birth_year.pack(side="left", padx=5)
        
        # ุงูุฌูุณ
        self.gender_label = ctk.CTkLabel(self.form_frame, text="ุงูุฌูุณ:")
        self.gender_label.pack(anchor="w")
        
        self.gender_var = ctk.StringVar(value="male")
        self.gender_frame = ctk.CTkFrame(self.form_frame)
        self.gender_frame.pack(anchor="w", pady=(0, 10))
        
        self.gender_male = ctk.CTkRadioButton(self.gender_frame, text="ุฐูุฑ", variable=self.gender_var, value="male", command=self.update_time_period)
        self.gender_male.pack(side="left", padx=10)
        
        self.gender_female = ctk.CTkRadioButton(self.gender_frame, text="ุฃูุซู", variable=self.gender_var, value="female", command=self.update_time_period)
        self.gender_female.pack(side="left", padx=10)
        
        # ุงููุชุฑุฉ ุงูููุถูุฉ (ูุชู ุชุญุฏูุฏูุง ุชููุงุฆููุง ุจูุงุกู ุนูู ุงูุฌูุณ)
        self.time_period_label = ctk.CTkLabel(self.form_frame, text="ุงููุชุฑุฉ ุงูููุถูุฉ:")
        self.time_period_label.pack(anchor="w")
        
        self.time_period_var = ctk.StringVar(value="men")
        self.time_period_frame = ctk.CTkFrame(self.form_frame)
        self.time_period_frame.pack(anchor="w", pady=(0, 10))
        
        self.time_period_men = ctk.CTkRadioButton(self.time_period_frame, text="ูุชุฑุฉ ุงูุฑุฌุงู", variable=self.time_period_var, value="men")
        self.time_period_men.pack(side="left", padx=10)
        
        self.time_period_women = ctk.CTkRadioButton(self.time_period_frame, text="ูุชุฑุฉ ุงูุณูุฏุงุช", variable=self.time_period_var, value="women")
        self.time_period_women.pack(side="left", padx=10)
        
        # ููุงุญุธุฉ ุญูู ุงููุชุฑุงุช
        self.note_label = ctk.CTkLabel(self.form_frame, text="ููุงุญุธุฉ: ูุชู ุชุญุฏูุฏ ุงููุชุฑุฉ ุชููุงุฆููุง ุจูุงุกู ุนูู ุงูุฌูุณ", text_color="gray70")
        self.note_label.pack(anchor="w", pady=(0, 10))
        
        # ุฃุฒุฑุงุฑ ุงูุญูุธ ูุงูุฅูุบุงุก
        self.buttons_frame = ctk.CTkFrame(self)
        self.buttons_frame.pack(fill="x", padx=20, pady=10)
        
        self.cancel_button = ctk.CTkButton(self.buttons_frame, text="ุฅูุบุงุก", command=self.destroy)
        self.cancel_button.pack(side="left", padx=5)
        
        self.save_button = ctk.CTkButton(self.buttons_frame, text="ุญูุธ", command=self.save_member)
        self.save_button.pack(side="right", padx=5)
        
        # ุชุญููู ุจูุงูุงุช ุงูุนุถู ูู ุญุงูุฉ ุงูุชุนุฏูู
        if self.is_edit_mode:
            self.load_member_data()
        
        # ุชุญุฏูุซ ุงููุชุฑุฉ ุงูููุถูุฉ ุจูุงุกู ุนูู ุงูุฌูุณ ุงููุญุฏุฏ
        self.update_time_period()
    
    def update_time_period(self, event=None):
        """ุชุญุฏูุซ ุงููุชุฑุฉ ุงูููุถูุฉ ุชููุงุฆููุง ุจูุงุกู ุนูู ุงูุฌูุณ ุงููุญุฏุฏ"""
        gender = self.gender_var.get()
        if gender == "male":
            self.time_period_var.set("men")
            self.time_period_men.configure(state="normal")
            self.time_period_women.configure(state="disabled")
        else:  # female
            self.time_period_var.set("women")
            self.time_period_men.configure(state="disabled")
            self.time_period_women.configure(state="normal")
    
    def load_member_data(self):
        """ุชุญููู ุจูุงูุงุช ุงูุนุถู ูู ุญุงูุฉ ุงูุชุนุฏูู"""
        if not self.member:
            return
        
        self.first_name_entry.insert(0, self.member.first_name)
        self.last_name_entry.insert(0, self.member.last_name)
        self.phone_entry.insert(0, self.member.phone)
        self.email_entry.insert(0, self.member.email if self.member.email else "")
        
        # ุชุญููู ุชุงุฑูุฎ ุงููููุงุฏ
        if self.member.birth_date:
            self.birth_day.set(str(self.member.birth_date.day))
            self.birth_month.set(str(self.member.birth_date.month))
            self.birth_year.set(str(self.member.birth_date.year))
        
        # ุชุญููู ุงูุฌูุณ ูุงููุชุฑุฉ ุงูููุถูุฉ
        self.gender_var.set(self.member.gender)
        self.time_period_var.set(self.member.preferred_time_period)
        self.update_time_period()
    
    def save_member(self):
        """ุญูุธ ุจูุงูุงุช ุงูุนุถู"""
        # ุฌูุน ุงูุจูุงูุงุช ูู ุงููููุฐุฌ
        member_data = {
            "first_name": self.first_name_entry.get(),
            "last_name": self.last_name_entry.get(),
            "phone": self.phone_entry.get(),
            "email": self.email_entry.get(),
            "birth_date": datetime.date(
                int(self.birth_year.get()),
                int(self.birth_month.get()),
                int(self.birth_day.get())
            ),
            "gender": self.gender_var.get(),
            "preferred_time_period": self.time_period_var.get()
        }
        
        # ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูุจูุงูุงุช
        if not member_data["first_name"] or not member_data["last_name"] or not member_data["phone"]:
            messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ููุก ุฌููุน ุงูุญููู ุงูุฅูุฒุงููุฉ")
            return
        
        # ุญูุธ ุงูุจูุงูุงุช
        if self.is_edit_mode:
            result = self.member_controller.update_member(self.member.id, member_data)
        else:
            result = self.member_controller.create_member(member_data)
        
        if result["success"]:
            messagebox.showinfo("ูุฌุงุญ", "ุชู ุญูุธ ุจูุงูุงุช ุงูุนุถู ุจูุฌุงุญ")
            self.destroy()
        else:
            messagebox.showerror("ุฎุทุฃ", result["error"])
```

#### 1.11 ููุฎุต ุชูููุฐ ูุธุงู ุงููุตู ุจูู ุงูุฌูุณูู

ูุชุถูู ุชูููุฐ ูุธุงู ุงููุตู ุจูู ุงูุฌูุณูู ูู ุชุทุจูู ุณุทุญ ุงูููุชุจ ุงูุนูุงุตุฑ ุงูุชุงููุฉ:

1. **ูููุฐุฌ ุงูุจูุงูุงุช ูุงูุชุนุฑููุงุช**:
   - ุชุนุฑูู ูุฆุฉ `TimePeriod` ูุชูุซูู ุงููุชุฑุงุช ุงูุฒูููุฉ (ุฑุฌุงูุ ุณูุฏุงุชุ ูุดุชุฑู).
   - ูุธุงุฆู ูุณุงุนุฏุฉ ููุชุญูู ูู ุตูุงุญูุงุช ุงููุตูู ุจูุงุกู ุนูู ุงููุชุฑุฉ ูุงูุฌูุณ.

2. **ุชุนุฏูู ูุธุงู ุงููุตุงุฏูุฉ**:
   - ุชุนุฏูู ุนูููุฉ ุชุณุฌูู ุงูุฏุฎูู ูุชุดูู ุงุฎุชูุงุฑ ุงููุชุฑุฉ ุงูุฒูููุฉ.
   - ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุณุชุฎุฏู ูููุตูู ุฅูู ุงููุชุฑุฉ ุงููุทููุจุฉ.
   - ุชุฎุฒูู ุงููุชุฑุฉ ุงููุญุฏุฏุฉ ูุน ุจูุงูุงุช ุงููุณุชุฎุฏู.

3. **ุชุนุฏูู ูุงุฌูุงุช ุงููุณุชุฎุฏู**:
   - ุฅุถุงูุฉ ุงุฎุชูุงุฑ ุงููุชุฑุฉ ูู ุดุงุดุฉ ุชุณุฌูู ุงูุฏุฎูู.
   - ุนุฑุถ ุงููุชุฑุฉ ุงูุญุงููุฉ ูู ุงูุดุฑูุท ุงูุนููู ููุชุทุจูู.
   - ุชุนุฏูู ููุงุฐุฌ ุฅุถุงูุฉ ูุชุนุฏูู ุงูุฃุนุถุงุก ูุชุญุฏูุฏ ุงููุชุฑุฉ ุงูููุถูุฉ ุชููุงุฆููุง ุจูุงุกู ุนูู ุงูุฌูุณ.

4. **ุชุนุฏูู ูุญุฏุงุช ุงูุชุญูู**:
   - ุชุนุฏูู ุฌููุน ูุญุฏุงุช ุงูุชุญูู ููุชุญูู ูู ุตูุงุญูุงุช ุงููุตูู ูุจู ุนุฑุถ ุฃู ุชุนุฏูู ุงูุจูุงูุงุช.
   - ุชุตููุฉ ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุจูุงุกู ุนูู ุงููุชุฑุฉ ุงูุญุงููุฉ ูููุณุชุฎุฏู.
   - ุชุณุฌูู ุงููุชุฑุฉ ุงูุฒูููุฉ ูุน ุงูุนูููุงุช ุงููุฎุชููุฉ (ุงูุญุถูุฑุ ุงููุจูุนุงุชุ ุฅูุฎ).

5. **ุชุนุฏูู ุงูุชูุงุฑูุฑ**:
   - ุชุตููุฉ ุจูุงูุงุช ุงูุชูุงุฑูุฑ ุจูุงุกู ุนูู ุงููุชุฑุฉ ุงูุฒูููุฉ ูููุณุชุฎุฏู.
   - ุนุฑุถ ุฅุญุตุงุฆูุงุช ูููุตูุฉ ููู ูุชุฑุฉ ูููุณุชุฎุฏููู ุฐูู ุงูุตูุงุญูุงุช ุงููุงููุฉ.

ูุฐุง ุงูุชูููุฐ ูุถูู ุงููุตู ุงููุงูู ุจูู ุจูุงูุงุช ูุชุฑุฉ ุงูุฑุฌุงู ููุชุฑุฉ ุงูุณูุฏุงุชุ ูุน ุงูุณูุงุญ ูููุฏุฑุงุก ุจุงููุตูู ุฅูู ุฌููุน ุงูุจูุงูุงุช ุนูุฏ ุงูุญุงุฌุฉ.

### 2. ูุธุงู ุงููุตุงุฏูุฉ

```python
# app/controllers/auth_controller.py
class AuthController:
    def __init__(self, db_service, security_service):
        self.db_service = db_service
        self.security_service = security_service
    
    def login(self, username, password):
        user = self.db_service.get_user_by_username(username)
        if user and self.security_service.verify_password(password, user.password_hash):
            return user
        return None
    
    def get_current_user(self):
        # ุงุณุชุฑุฌุงุน ุงููุณุชุฎุฏู ุงูุญุงูู ูู ุงูุฌูุณุฉ ุงููุญููุฉ
        return self.db_service.get_user_by_id(self.security_service.get_current_user_id())

# app/views/auth_view.py
class LoginWindow(ctk.CTkToplevel):
    def __init__(self, parent, auth_controller):
        super().__init__(parent)
        self.auth_controller = auth_controller
        self.title("ุชุณุฌูู ุงูุฏุฎูู")
        self.geometry("400x300")
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.username_label = ctk.CTkLabel(self, text="ุงุณู ุงููุณุชุฎุฏู:")
        self.username_label.pack(pady=10)
        
        self.username_entry = ctk.CTkEntry(self, width=200)
        self.username_entry.pack(pady=5)
        
        self.password_label = ctk.CTkLabel(self, text="ูููุฉ ุงููุฑูุฑ:")
        self.password_label.pack(pady=10)
        
        self.password_entry = ctk.CTkEntry(self, width=200, show="*")
        self.password_entry.pack(pady=5)
        
        self.login_button = ctk.CTkButton(self, text="ุชุณุฌูู ุงูุฏุฎูู", command=self.login)
        self.login_button.pack(pady=20)
        
        self.error_label = ctk.CTkLabel(self, text="", text_color="red")
        self.error_label.pack(pady=10)
    
    def login(self):
        username = self.username_entry.get()
        password = self.password_entry.get()
        
        user = self.auth_controller.login(username, password)
        if user:
            self.destroy()  # ุฅุบูุงู ูุงูุฐุฉ ุชุณุฌูู ุงูุฏุฎูู
            self.master.show_main_window(user)  # ุนุฑุถ ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
        else:
            self.error_label.configure(text="ุงุณู ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ")
```

### 2. ูุธุงู ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก

```python
# app/views/members_view.py
class MembersListFrame(ctk.CTkFrame):
    def __init__(self, parent, member_controller):
        super().__init__(parent)
        self.member_controller = member_controller
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.title_label = ctk.CTkLabel(self, text="ูุงุฆูุฉ ุงูุฃุนุถุงุก", font=ctk.CTkFont(size=20, weight="bold"))
        self.title_label.pack(pady=10)
        
        # ุดุฑูุท ุงูุจุญุซ
        self.search_frame = ctk.CTkFrame(self)
        self.search_frame.pack(fill="x", padx=10, pady=10)
        
        self.search_label = ctk.CTkLabel(self.search_frame, text="ุจุญุซ:")
        self.search_label.pack(side="right", padx=5)
        
        self.search_entry = ctk.CTkEntry(self.search_frame, width=200)
        self.search_entry.pack(side="right", padx=5)
        self.search_entry.bind("<KeyRelease>", self.search_members)
        
        self.add_button = ctk.CTkButton(self.search_frame, text="ุฅุถุงูุฉ ุนุถู", command=self.add_member)
        self.add_button.pack(side="left", padx=5)
        
        # ุฌุฏูู ุงูุฃุนุถุงุก
        self.tree_frame = ctk.CTkFrame(self)
        self.tree_frame.pack(fill="both", expand=True, padx=10, pady=10)
        
        columns = ("member_code", "name", "phone", "status", "join_date")
        self.tree = ttk.Treeview(self.tree_frame, columns=columns, show="headings")
        
        # ุชุนููู ุนูุงููู ุงูุฃุนูุฏุฉ
        self.tree.heading("member_code", text="ููุฏ ุงูุนุถู")
        self.tree.heading("name", text="ุงูุงุณู")
        self.tree.heading("phone", text="ุงููุงุชู")
        self.tree.heading("status", text="ุงูุญุงูุฉ")
        self.tree.heading("join_date", text="ุชุงุฑูุฎ ุงูุงูุถูุงู")
        
        # ุชุนููู ุฃุญุฌุงู ุงูุฃุนูุฏุฉ
        self.tree.column("member_code", width=100)
        self.tree.column("name", width=200)
        self.tree.column("phone", width=150)
        self.tree.column("status", width=100)
        self.tree.column("join_date", width=150)
        
        # ุฅุถุงูุฉ ุดุฑูุท ุงูุชูุฑูุฑ
        scrollbar = ttk.Scrollbar(self.tree_frame, orient="vertical", command=self.tree.yview)
        self.tree.configure(yscrollcommand=scrollbar.set)
        scrollbar.pack(side="right", fill="y")
        self.tree.pack(side="left", fill="both", expand=True)
        
        # ุฑุจุท ุญุฏุซ ุงูููุฑ ุงููุฒุฏูุฌ ูุนุฑุถ ุชูุงุตูู ุงูุนุถู
        self.tree.bind("<Double-1>", self.view_member)
        
        # ุชุญููู ุจูุงูุงุช ุงูุฃุนุถุงุก
        self.load_members()
    
    def load_members(self):
        # ูุณุญ ุงูุจูุงูุงุช ุงูุญุงููุฉ
        for item in self.tree.get_children():
            self.tree.delete(item)
        
        # ุชุญููู ุจูุงูุงุช ุงูุฃุนุถุงุก ูู ูุญุฏุฉ ุงูุชุญูู
        members = self.member_controller.get_all_members()
        for member in members:
            self.tree.insert("", "end", values=(
                member.member_code,
                f"{member.first_name} {member.last_name}",
                member.phone,
                member.status,
                member.join_date.strftime("%Y-%m-%d")
            ))
    
    def search_members(self, event):
        search_text = self.search_entry.get()
        # ูุณุญ ุงูุจูุงูุงุช ุงูุญุงููุฉ
        for item in self.tree.get_children():
            self.tree.delete(item)
        
        # ุงูุจุญุซ ุนู ุงูุฃุนุถุงุก
        members = self.member_controller.search_members(search_text)
        for member in members:
            self.tree.insert("", "end", values=(
                member.member_code,
                f"{member.first_name} {member.last_name}",
                member.phone,
                member.status,
                member.join_date.strftime("%Y-%m-%d")
            ))
    
    def add_member(self):
        # ูุชุญ ูุงูุฐุฉ ุฅุถุงูุฉ ุนุถู ุฌุฏูุฏ
        add_window = MemberFormWindow(self.winfo_toplevel(), self.member_controller)
        add_window.wait_window()  # ุงูุชุธุงุฑ ุฅุบูุงู ุงููุงูุฐุฉ
        self.load_members()  # ุฅุนุงุฏุฉ ุชุญููู ุงูุจูุงูุงุช
    
    def view_member(self, event):
        # ุงูุญุตูู ุนูู ุงูุนูุตุฑ ุงููุญุฏุฏ
        selected_item = self.tree.selection()[0]
        member_code = self.tree.item(selected_item, "values")[0]
        
        # ูุชุญ ูุงูุฐุฉ ุนุฑุถ ุชูุงุตูู ุงูุนุถู
        member = self.member_controller.get_member_by_code(member_code)
        view_window = MemberDetailsWindow(self.winfo_toplevel(), self.member_controller, member)
        view_window.wait_window()  # ุงูุชุธุงุฑ ุฅุบูุงู ุงููุงูุฐุฉ
        self.load_members()  # ุฅุนุงุฏุฉ ุชุญููู ุงูุจูุงูุงุช
```

### 3. ูุธุงู ุงูุงุดุชุฑุงูุงุช

```python
# app/controllers/subscription_controller.py
class SubscriptionController:
    def __init__(self, db_service, subscription_service):
        self.db_service = db_service
        self.subscription_service = subscription_service
    
    def get_member_subscriptions(self, member_id):
        return self.db_service.get_subscriptions_by_member(member_id)
    
    def create_subscription(self, subscription_data):
        # ุฅูุดุงุก ุงุดุชุฑุงู ุฌุฏูุฏ
        try:
            # ุญุณุงุจ ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
            plan = self.db_service.get_plan_by_id(subscription_data['plan_id'])
            start_date = subscription_data.get('start_date', datetime.date.today())
            end_date = self.subscription_service.calculate_end_date(start_date, plan.duration_days)
            
            # ุญุณุงุจ ุงูุณุนุฑ ุงูููุงุฆู ุจุนุฏ ุงูุฎุตู
            price = plan.price
            discount = subscription_data.get('discount', 0)
            final_price = price - discount
            
            # ุฅูุดุงุก ุงูุงุดุชุฑุงู
            subscription = Subscription(
                member_id=subscription_data['member_id'],
                plan_id=subscription_data['plan_id'],
                start_date=start_date,
                end_date=end_date,
                status='active',
                total_sessions=plan.sessions_count,
                remaining_sessions=plan.sessions_count,
                price=price,
                discount=discount,
                final_price=final_price,
                paid_amount=subscription_data.get('paid_amount', 0),
                payment_status='unpaid' if final_price > subscription_data.get('paid_amount', 0) else 'paid'
            )
            
            # ุญูุธ ุงูุงุดุชุฑุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
            self.db_service.add_subscription(subscription)
            
            # ุฅูุดุงุก ูุงุชูุฑุฉ ููุงุดุชุฑุงู
            if subscription_data.get('create_invoice', True):
                self.create_subscription_invoice(subscription)
            
            return {'success': True, 'subscription': subscription}
        except Exception as e:
            return {'success': False, 'error': str(e)}

# app/views/subscription_view.py
class SubscriptionFormWindow(ctk.CTkToplevel):
    def __init__(self, parent, subscription_controller, member=None):
        super().__init__(parent)
        self.subscription_controller = subscription_controller
        self.member = member
        
        self.title("ุฅุถุงูุฉ ุงุดุชุฑุงู ุฌุฏูุฏ")
        self.geometry("600x500")
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.title_label = ctk.CTkLabel(self, text="ุฅุถุงูุฉ ุงุดุชุฑุงู ุฌุฏูุฏ", font=ctk.CTkFont(size=20, weight="bold"))
        self.title_label.pack(pady=10)
        
        # ุฅุทุงุฑ ุงููููุฐุฌ
        self.form_frame = ctk.CTkFrame(self)
        self.form_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        # ุงูุนุถู
        self.member_label = ctk.CTkLabel(self.form_frame, text="ุงูุนุถู:")
        self.member_label.grid(row=0, column=0, padx=10, pady=10, sticky="e")
        
        if member:
            self.member_value = ctk.CTkLabel(self.form_frame, text=f"{member.first_name} {member.last_name}")
            self.member_value.grid(row=0, column=1, padx=10, pady=10, sticky="w")
        else:
            self.member_button = ctk.CTkButton(self.form_frame, text="ุงุฎุชูุงุฑ ุนุถู", command=self.select_member)
            self.member_button.grid(row=0, column=1, padx=10, pady=10, sticky="w")
            self.selected_member = None
        
        # ุฎุทุฉ ุงูุนุถููุฉ
        self.plan_label = ctk.CTkLabel(self.form_frame, text="ุฎุทุฉ ุงูุนุถููุฉ:")
        self.plan_label.grid(row=1, column=0, padx=10, pady=10, sticky="e")
        
        # ุงูุญุตูู ุนูู ุฎุทุท ุงูุนุถููุฉ ุงููุชุงุญุฉ
        self.plans = self.subscription_controller.db_service.get_all_plans()
        plan_names = [plan.name for plan in self.plans]
        
        self.plan_combobox = ctk.CTkComboBox(self.form_frame, values=plan_names, width=200)
        self.plan_combobox.grid(row=1, column=1, padx=10, pady=10, sticky="w")
        self.plan_combobox.bind("<<ComboboxSelected>>", self.update_price)
        
        # ุชุงุฑูุฎ ุงูุจุฏุงูุฉ
        self.start_date_label = ctk.CTkLabel(self.form_frame, text="ุชุงุฑูุฎ ุงูุจุฏุงูุฉ:")
        self.start_date_label.grid(row=2, column=0, padx=10, pady=10, sticky="e")
        
        self.start_date_frame = ctk.CTkFrame(self.form_frame)
        self.start_date_frame.grid(row=2, column=1, padx=10, pady=10, sticky="w")
        
        today = datetime.date.today()
        
        self.start_day = ctk.CTkComboBox(self.start_date_frame, values=[str(i) for i in range(1, 32)], width=60)
        self.start_day.set(str(today.day))
        self.start_day.pack(side="right", padx=2)
        
        self.start_month = ctk.CTkComboBox(self.start_date_frame, values=[str(i) for i in range(1, 13)], width=60)
        self.start_month.set(str(today.month))
        self.start_month.pack(side="right", padx=2)
        
        self.start_year = ctk.CTkComboBox(self.start_date_frame, values=[str(i) for i in range(today.year - 5, today.year + 6)], width=80)
        self.start_year.set(str(today.year))
        self.start_year.pack(side="right", padx=2)
        
        # ุงูุณุนุฑ
        self.price_label = ctk.CTkLabel(self.form_frame, text="ุงูุณุนุฑ:")
        self.price_label.grid(row=3, column=0, padx=10, pady=10, sticky="e")
        
        self.price_value = ctk.CTkLabel(self.form_frame, text="0")
        self.price_value.grid(row=3, column=1, padx=10, pady=10, sticky="w")
        
        # ุงูุฎุตู
        self.discount_label = ctk.CTkLabel(self.form_frame, text="ุงูุฎุตู:")
        self.discount_label.grid(row=4, column=0, padx=10, pady=10, sticky="e")
        
        self.discount_entry = ctk.CTkEntry(self.form_frame, width=100)
        self.discount_entry.insert(0, "0")
        self.discount_entry.grid(row=4, column=1, padx=10, pady=10, sticky="w")
        self.discount_entry.bind("<KeyRelease>", self.update_final_price)
        
        # ุงูุณุนุฑ ุงูููุงุฆู
        self.final_price_label = ctk.CTkLabel(self.form_frame, text="ุงูุณุนุฑ ุงูููุงุฆู:")
        self.final_price_label.grid(row=5, column=0, padx=10, pady=10, sticky="e")
        
        self.final_price_value = ctk.CTkLabel(self.form_frame, text="0")
        self.final_price_value.grid(row=5, column=1, padx=10, pady=10, sticky="w")
        
        # ุงููุจูุบ ุงููุฏููุน
        self.paid_amount_label = ctk.CTkLabel(self.form_frame, text="ุงููุจูุบ ุงููุฏููุน:")
        self.paid_amount_label.grid(row=6, column=0, padx=10, pady=10, sticky="e")
        
        self.paid_amount_entry = ctk.CTkEntry(self.form_frame, width=100)
        self.paid_amount_entry.insert(0, "0")
        self.paid_amount_entry.grid(row=6, column=1, padx=10, pady=10, sticky="w")
        
        # ุฅูุดุงุก ูุงุชูุฑุฉ
        self.create_invoice_var = ctk.BooleanVar(value=True)
        self.create_invoice_checkbox = ctk.CTkCheckBox(self.form_frame, text="ุฅูุดุงุก ูุงุชูุฑุฉ", variable=self.create_invoice_var)
        self.create_invoice_checkbox.grid(row=7, column=1, padx=10, pady=10, sticky="w")
        
        # ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช
        self.buttons_frame = ctk.CTkFrame(self)
        self.buttons_frame.pack(fill="x", padx=20, pady=10)
        
        self.cancel_button = ctk.CTkButton(self.buttons_frame, text="ุฅูุบุงุก", command=self.destroy)
        self.cancel_button.pack(side="right", padx=10)
        
        self.save_button = ctk.CTkButton(self.buttons_frame, text="ุญูุธ", command=self.save_subscription)
        self.save_button.pack(side="right", padx=10)
        
        # ุชุญุฏูุซ ุงูุณุนุฑ ุนูุฏ ุงุฎุชูุงุฑ ุฎุทุฉ
        if self.plans:
            self.plan_combobox.set(self.plans[0].name)
            self.update_price(None)
    
    def select_member(self):
        # ูุชุญ ูุงูุฐุฉ ุงุฎุชูุงุฑ ุนุถู
        select_window = MemberSelectorWindow(self, self.subscription_controller.db_service)
        self.wait_window(select_window)
        
        if hasattr(select_window, 'selected_member') and select_window.selected_member:
            self.selected_member = select_window.selected_member
            self.member_button.configure(text=f"{self.selected_member.first_name} {self.selected_member.last_name}")
    
    def update_price(self, event):
        plan_name = self.plan_combobox.get()
        for plan in self.plans:
            if plan.name == plan_name:
                self.price_value.configure(text=str(plan.price))
                self.update_final_price(None)
                break
    
    def update_final_price(self, event):
        try:
            price = float(self.price_value.cget("text"))
            discount = float(self.discount_entry.get() or 0)
            final_price = price - discount
            if final_price < 0:
                final_price = 0
            self.final_price_value.configure(text=str(final_price))
        except ValueError:
            self.final_price_value.configure(text="ุฎุทุฃ ูู ุงูููู")
    
    def save_subscription(self):
        try:
            # ุงูุชุญูู ูู ุงุฎุชูุงุฑ ุนุถู
            member_id = self.member.id if self.member else (self.selected_member.id if self.selected_member else None)
            if not member_id:
                messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ุงุฎุชูุงุฑ ุนุถู")
                return
            
            # ุงูุญุตูู ุนูู ุฎุทุฉ ุงูุนุถููุฉ ุงููุญุฏุฏุฉ
            plan_name = self.plan_combobox.get()
            plan_id = None
            for plan in self.plans:
                if plan.name == plan_name:
                    plan_id = plan.id
                    break
            
            if not plan_id:
                messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ุงุฎุชูุงุฑ ุฎุทุฉ ุนุถููุฉ ุตุงูุญุฉ")
                return
            
            # ุชุญููู ุชุงุฑูุฎ ุงูุจุฏุงูุฉ
            try:
                start_date = datetime.date(
                    int(self.start_year.get()),
                    int(self.start_month.get()),
                    int(self.start_day.get())
                )
            except ValueError:
                messagebox.showerror("ุฎุทุฃ", "ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ุบูุฑ ุตุงูุญ")
                return
            
            # ุงูุญุตูู ุนูู ููู ุงููููุฐุฌ
            discount = float(self.discount_entry.get() or 0)
            paid_amount = float(self.paid_amount_entry.get() or 0)
            create_invoice = self.create_invoice_var.get()
            
            # ุฅูุดุงุก ุจูุงูุงุช ุงูุงุดุชุฑุงู
            subscription_data = {
                'member_id': member_id,
                'plan_id': plan_id,
                'start_date': start_date,
                'discount': discount,
                'paid_amount': paid_amount,
                'create_invoice': create_invoice
            }
            
            # ุญูุธ ุงูุงุดุชุฑุงู
            result = self.subscription_controller.create_subscription(subscription_data)
            
            if result['success']:
                messagebox.showinfo("ูุฌุงุญ", "ุชู ุฅูุดุงุก ุงูุงุดุชุฑุงู ุจูุฌุงุญ")
                self.destroy()
            else:
                messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ: {result['error']}")
        
        except Exception as e:
            messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน: {str(e)}")
```

## ๐ ุชุญููู ุชุฏููุงุช ุงูุนูู ุงูุฑุฆูุณูุฉ

### 1. ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู

```python
# app/views/attendance_view.py
class AttendanceFrame(ctk.CTkFrame):
    def __init__(self, parent, attendance_controller):
        super().__init__(parent)
        self.attendance_controller = attendance_controller
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.title_label = ctk.CTkLabel(self, text="ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู", font=ctk.CTkFont(size=20, weight="bold"))
        self.title_label.pack(pady=10)
        
        # ุฅุทุงุฑ ุงูุจุญุซ
        self.search_frame = ctk.CTkFrame(self)
        self.search_frame.pack(fill="x", padx=20, pady=10)
        
        self.search_label = ctk.CTkLabel(self.search_frame, text="ููุฏ ุงูุนุถู:")
        self.search_label.pack(side="right", padx=5)
        
        self.search_entry = ctk.CTkEntry(self.search_frame, width=200)
        self.search_entry.pack(side="right", padx=5)
        self.search_entry.bind("<Return>", self.search_member)
        
        self.search_button = ctk.CTkButton(self.search_frame, text="ุจุญุซ", command=lambda: self.search_member(None))
        self.search_button.pack(side="right", padx=5)
        
        # ุฅุทุงุฑ ูุนูููุงุช ุงูุนุถู
        self.member_frame = ctk.CTkFrame(self)
        self.member_frame.pack(fill="x", padx=20, pady=10)
        
        self.member_info_label = ctk.CTkLabel(self.member_frame, text="ูุนูููุงุช ุงูุนุถู", font=ctk.CTkFont(weight="bold"))
        self.member_info_label.pack(pady=5)
        
        self.member_name_label = ctk.CTkLabel(self.member_frame, text="ุงูุงุณู: ")
        self.member_name_label.pack(pady=2)
        
        self.member_code_label = ctk.CTkLabel(self.member_frame, text="ููุฏ ุงูุนุถู: ")
        self.member_code_label.pack(pady=2)
        
        self.subscription_status_label = ctk.CTkLabel(self.member_frame, text="ุญุงูุฉ ุงูุงุดุชุฑุงู: ")
        self.subscription_status_label.pack(pady=2)
        
        self.remaining_sessions_label = ctk.CTkLabel(self.member_frame, text="ุงูุญุตุต ุงููุชุจููุฉ: ")
        self.remaining_sessions_label.pack(pady=2)
        
        # ุฅุทุงุฑ ุงูุฅุฌุฑุงุกุงุช
        self.actions_frame = ctk.CTkFrame(self)
        self.actions_frame.pack(fill="x", padx=20, pady=10)
        
        self.check_in_button = ctk.CTkButton(self.actions_frame, text="ุชุณุฌูู ุงูุญุถูุฑ", command=self.check_in)
        self.check_in_button.pack(side="right", padx=10, pady=10)
        
        self.check_out_button = ctk.CTkButton(self.actions_frame, text="ุชุณุฌูู ุงูุงูุตุฑุงู", command=self.check_out)
        self.check_out_button.pack(side="right", padx=10, pady=10)
        
        # ุชุนุทูู ุงูุฃุฒุฑุงุฑ ูู ุงูุจุฏุงูุฉ
        self.check_in_button.configure(state="disabled")
        self.check_out_button.configure(state="disabled")
        
        # ุญุงูุฉ ุงูุนุถู ุงูุญุงูู
        self.current_member = None
        self.current_attendance = None
    
    def search_member(self, event):
        member_code = self.search_entry.get()
        if not member_code:
            messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุฅุฏุฎุงู ููุฏ ุงูุนุถู")
            return
        
        # ุงูุจุญุซ ุนู ุงูุนุถู
        member = self.attendance_controller.get_member_by_code(member_code)
        if not member:
            messagebox.showerror("ุฎุทุฃ", "ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุนุถู")
            return
        
        # ุนุฑุถ ูุนูููุงุช ุงูุนุถู
        self.current_member = member
        self.member_name_label.configure(text=f"ุงูุงุณู: {member.first_name} {member.last_name}")
        self.member_code_label.configure(text=f"ููุฏ ุงูุนุถู: {member.member_code}")
        
        # ุงูุชุญูู ูู ุญุงูุฉ ุงูุงุดุชุฑุงู
        subscription = self.attendance_controller.get_active_subscription(member.id)
        if subscription:
            self.subscription_status_label.configure(text=f"ุญุงูุฉ ุงูุงุดุชุฑุงู: {subscription.status}")
            self.remaining_sessions_label.configure(text=f"ุงูุญุตุต ุงููุชุจููุฉ: {subscription.remaining_sessions}")
            
            # ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูุงุดุชุฑุงู
            validity_check = self.attendance_controller.check_subscription_validity(subscription.id)
            if validity_check['valid']:
                # ุงูุชุญูู ูู ูุฌูุฏ ุญุถูุฑ ููุชูุญ
                attendance = self.attendance_controller.get_open_attendance(member.id)
                if attendance:
                    self.current_attendance = attendance
                    self.check_in_button.configure(state="disabled")
                    self.check_out_button.configure(state="normal")
                else:
                    self.current_attendance = None
                    self.check_in_button.configure(state="normal")
                    self.check_out_button.configure(state="disabled")
            else:
                messagebox.showwarning("ุชูุจูู", f"ุงูุงุดุชุฑุงู ุบูุฑ ุตุงูุญ: {validity_check['reason']}")
                self.check_in_button.configure(state="disabled")
                self.check_out_button.configure(state="disabled")
        else:
            self.subscription_status_label.configure(text="ุญุงูุฉ ุงูุงุดุชุฑุงู: ูุง ููุฌุฏ ุงุดุชุฑุงู ูุดุท")
            self.remaining_sessions_label.configure(text="ุงูุญุตุต ุงููุชุจููุฉ: 0")
            messagebox.showwarning("ุชูุจูู", "ูุง ููุฌุฏ ุงุดุชุฑุงู ูุดุท ููุฐุง ุงูุนุถู")
            self.check_in_button.configure(state="disabled")
            self.check_out_button.configure(state="disabled")
    
    def check_in(self):
        if not self.current_member:
            return
        
        # ุชุณุฌูู ุงูุญุถูุฑ
        result = self.attendance_controller.check_in(self.current_member.id)
        if result['success']:
            messagebox.showinfo("ูุฌุงุญ", "ุชู ุชุณุฌูู ุงูุญุถูุฑ ุจูุฌุงุญ")
            self.current_attendance = result['attendance']
            self.check_in_button.configure(state="disabled")
            self.check_out_button.configure(state="normal")
            
            # ุชุญุฏูุซ ุนุฏุฏ ุงูุญุตุต ุงููุชุจููุฉ
            subscription = self.attendance_controller.get_active_subscription(self.current_member.id)
            if subscription:
                self.remaining_sessions_label.configure(text=f"ุงูุญุตุต ุงููุชุจููุฉ: {subscription.remaining_sessions}")
        else:
            messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ: {result['error']}")
    
    def check_out(self):
        if not self.current_attendance:
            return
        
        # ุชุณุฌูู ุงูุงูุตุฑุงู
        result = self.attendance_controller.check_out(self.current_attendance.id)
        if result['success']:
            messagebox.showinfo("ูุฌุงุญ", "ุชู ุชุณุฌูู ุงูุงูุตุฑุงู ุจูุฌุงุญ")
            self.current_attendance = None
            self.check_in_button.configure(state="normal")
            self.check_out_button.configure(state="disabled")
        else:
            messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ: {result['error']}")
```

### 2. ุฅูุดุงุก ูุทุจุงุนุฉ ุงูููุงุชูุฑ

```python
# app/controllers/invoice_controller.py
class InvoiceController:
    def __init__(self, db_service, invoice_service):
        self.db_service = db_service
        self.invoice_service = invoice_service
    
    def create_invoice(self, invoice_data):
        try:
            # ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ
            invoice = Invoice(
                member_id=invoice_data['member_id'],
                invoice_date=datetime.date.today(),
                invoice_number=self.invoice_service.generate_invoice_number(),
                total_amount=invoice_data['total_amount'],
                paid_amount=invoice_data.get('paid_amount', 0),
                payment_status='unpaid' if invoice_data['total_amount'] > invoice_data.get('paid_amount', 0) else 'paid',
                notes=invoice_data.get('notes', '')
            )
            
            # ุฅุถุงูุฉ ุนูุงุตุฑ ุงููุงุชูุฑุฉ
            invoice_items = []
            for item_data in invoice_data['items']:
                item = InvoiceItem(
                    description=item_data['description'],
                    quantity=item_data['quantity'],
                    unit_price=item_data['unit_price'],
                    total_price=item_data['quantity'] * item_data['unit_price']
                )
                invoice_items.append(item)
            
            # ุญูุธ ุงููุงุชูุฑุฉ ูุนูุงุตุฑูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
            self.db_service.add_invoice(invoice, invoice_items)
            
            return {'success': True, 'invoice': invoice}
        except Exception as e:
            return {'success': False, 'error': str(e)}
    
    def generate_invoice_pdf(self, invoice_id):
        try:
            # ุงูุญุตูู ุนูู ุงููุงุชูุฑุฉ ูุนูุงุตุฑูุง
            invoice = self.db_service.get_invoice_by_id(invoice_id)
            if not invoice:
                return {'success': False, 'error': 'ุงููุงุชูุฑุฉ ุบูุฑ ููุฌูุฏุฉ'}
            
            # ุฅูุดุงุก ููู PDF
            pdf_path = self.invoice_service.generate_invoice_pdf(invoice)
            
            return {'success': True, 'pdf_path': pdf_path}
        except Exception as e:
            return {'success': False, 'error': str(e)}

# app/views/invoice_view.py
class InvoiceFormWindow(ctk.CTkToplevel):
    def __init__(self, parent, invoice_controller, member=None):
        super().__init__(parent)
        self.invoice_controller = invoice_controller
        self.member = member
        
        self.title("ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ")
        self.geometry("800x600")
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.title_label = ctk.CTkLabel(self, text="ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ", font=ctk.CTkFont(size=20, weight="bold"))
        self.title_label.pack(pady=10)
        
        # ุฅุทุงุฑ ูุนูููุงุช ุงููุงุชูุฑุฉ
        self.info_frame = ctk.CTkFrame(self)
        self.info_frame.pack(fill="x", padx=20, pady=10)
        
        # ุงูุนุถู
        self.member_label = ctk.CTkLabel(self.info_frame, text="ุงูุนุถู:")
        self.member_label.grid(row=0, column=0, padx=10, pady=10, sticky="e")
        
        if member:
            self.member_value = ctk.CTkLabel(self.info_frame, text=f"{member.first_name} {member.last_name}")
            self.member_value.grid(row=0, column=1, padx=10, pady=10, sticky="w")
        else:
            self.member_button = ctk.CTkButton(self.info_frame, text="ุงุฎุชูุงุฑ ุนุถู", command=self.select_member)
            self.member_button.grid(row=0, column=1, padx=10, pady=10, sticky="w")
            self.selected_member = None
        
        # ุงูุชุงุฑูุฎ
        self.date_label = ctk.CTkLabel(self.info_frame, text="ุงูุชุงุฑูุฎ:")
        self.date_label.grid(row=0, column=2, padx=10, pady=10, sticky="e")
        
        today = datetime.date.today()
        self.date_value = ctk.CTkLabel(self.info_frame, text=today.strftime("%Y-%m-%d"))
        self.date_value.grid(row=0, column=3, padx=10, pady=10, sticky="w")
        
        # ุงูููุงุญุธุงุช
        self.notes_label = ctk.CTkLabel(self.info_frame, text="ููุงุญุธุงุช:")
        self.notes_label.grid(row=1, column=0, padx=10, pady=10, sticky="e")
        
        self.notes_entry = ctk.CTkEntry(self.info_frame, width=300)
        self.notes_entry.grid(row=1, column=1, columnspan=3, padx=10, pady=10, sticky="w")
        
        # ุฅุทุงุฑ ุนูุงุตุฑ ุงููุงุชูุฑุฉ
        self.items_frame = ctk.CTkFrame(self)
        self.items_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        self.items_label = ctk.CTkLabel(self.items_frame, text="ุนูุงุตุฑ ุงููุงุชูุฑุฉ", font=ctk.CTkFont(weight="bold"))
        self.items_label.pack(pady=5)
        
        # ุฌุฏูู ุงูุนูุงุตุฑ
        self.tree_frame = ctk.CTkFrame(self.items_frame)
        self.tree_frame.pack(fill="both", expand=True, padx=10, pady=5)
        
        columns = ("description", "quantity", "unit_price", "total_price")
        self.tree = ttk.Treeview(self.tree_frame, columns=columns, show="headings")
        
        # ุชุนููู ุนูุงููู ุงูุฃุนูุฏุฉ
        self.tree.heading("description", text="ุงููุตู")
        self.tree.heading("quantity", text="ุงููููุฉ")
        self.tree.heading("unit_price", text="ุณุนุฑ ุงููุญุฏุฉ")
        self.tree.heading("total_price", text="ุงูุณุนุฑ ุงูุฅุฌูุงูู")
        
        # ุชุนููู ุฃุญุฌุงู ุงูุฃุนูุฏุฉ
        self.tree.column("description", width=300)
        self.tree.column("quantity", width=100)
        self.tree.column("unit_price", width=100)
        self.tree.column("total_price", width=100)
        
        # ุฅุถุงูุฉ ุดุฑูุท ุงูุชูุฑูุฑ
        scrollbar = ttk.Scrollbar(self.tree_frame, orient="vertical", command=self.tree.yview)
        self.tree.configure(yscrollcommand=scrollbar.set)
        scrollbar.pack(side="right", fill="y")
        self.tree.pack(side="left", fill="both", expand=True)
        
        # ุฃุฒุฑุงุฑ ุฅุฏุงุฑุฉ ุงูุนูุงุตุฑ
        self.item_buttons_frame = ctk.CTkFrame(self.items_frame)
        self.item_buttons_frame.pack(fill="x", padx=10, pady=5)
        
        self.add_item_button = ctk.CTkButton(self.item_buttons_frame, text="ุฅุถุงูุฉ ุนูุตุฑ", command=self.add_item)
        self.add_item_button.pack(side="left", padx=5)
        
        self.edit_item_button = ctk.CTkButton(self.item_buttons_frame, text="ุชุนุฏูู ุนูุตุฑ", command=self.edit_item)
        self.edit_item_button.pack(side="left", padx=5)
        
        self.remove_item_button = ctk.CTkButton(self.item_buttons_frame, text="ุญุฐู ุนูุตุฑ", command=self.remove_item)
        self.remove_item_button.pack(side="left", padx=5)
        
        # ุฅุทุงุฑ ุงููุฌุงููุน
        self.totals_frame = ctk.CTkFrame(self)
        self.totals_frame.pack(fill="x", padx=20, pady=10)
        
        # ุงููุฌููุน
        self.total_label = ctk.CTkLabel(self.totals_frame, text="ุงููุฌููุน:")
        self.total_label.grid(row=0, column=0, padx=10, pady=5, sticky="e")
        
        self.total_value = ctk.CTkLabel(self.totals_frame, text="0")
        self.total_value.grid(row=0, column=1, padx=10, pady=5, sticky="w")
        
        # ุงููุจูุบ ุงููุฏููุน
        self.paid_amount_label = ctk.CTkLabel(self.totals_frame, text="ุงููุจูุบ ุงููุฏููุน:")
        self.paid_amount_label.grid(row=1, column=0, padx=10, pady=5, sticky="e")
        
        self.paid_amount_entry = ctk.CTkEntry(self.totals_frame, width=100)
        self.paid_amount_entry.insert(0, "0")
        self.paid_amount_entry.grid(row=1, column=1, padx=10, pady=5, sticky="w")
        
        # ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช
        self.buttons_frame = ctk.CTkFrame(self)
        self.buttons_frame.pack(fill="x", padx=20, pady=10)
        
        self.cancel_button = ctk.CTkButton(self.buttons_frame, text="ุฅูุบุงุก", command=self.destroy)
        self.cancel_button.pack(side="right", padx=10)
        
        self.save_button = ctk.CTkButton(self.buttons_frame, text="ุญูุธ", command=self.save_invoice)
        self.save_button.pack(side="right", padx=10)
        
        self.save_print_button = ctk.CTkButton(self.buttons_frame, text="ุญูุธ ูุทุจุงุนุฉ", command=self.save_and_print)
        self.save_print_button.pack(side="right", padx=10)
        
        # ูุงุฆูุฉ ุงูุนูุงุตุฑ
        self.invoice_items = []
    
    def select_member(self):
        # ูุชุญ ูุงูุฐุฉ ุงุฎุชูุงุฑ ุนุถู
        select_window = MemberSelectorWindow(self, self.invoice_controller.db_service)
        self.wait_window(select_window)
        
        if hasattr(select_window, 'selected_member') and select_window.selected_member:
            self.selected_member = select_window.selected_member
            self.member_button.configure(text=f"{self.selected_member.first_name} {self.selected_member.last_name}")
    
    def add_item(self):
        # ูุชุญ ูุงูุฐุฉ ุฅุถุงูุฉ ุนูุตุฑ
        item_window = InvoiceItemWindow(self)
        self.wait_window(item_window)
        
        if hasattr(item_window, 'item_data') and item_window.item_data:
            # ุฅุถุงูุฉ ุงูุนูุตุฑ ุฅูู ุงููุงุฆูุฉ
            self.invoice_items.append(item_window.item_data)
            
            # ุฅุถุงูุฉ ุงูุนูุตุฑ ุฅูู ุงูุฌุฏูู
            self.tree.insert("", "end", values=(
                item_window.item_data['description'],
                item_window.item_data['quantity'],
                item_window.item_data['unit_price'],
                item_window.item_data['quantity'] * item_window.item_data['unit_price']
            ))
            
            # ุชุญุฏูุซ ุงููุฌููุน
            self.update_total()
    
    def edit_item(self):
        # ุงูุชุญูู ูู ุชุญุฏูุฏ ุนูุตุฑ
        selected_items = self.tree.selection()
        if not selected_items:
            messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุชุญุฏูุฏ ุนูุตุฑ ููุชุนุฏูู")
            return
        
        # ุงูุญุตูู ุนูู ุงูุนูุตุฑ ุงููุญุฏุฏ
        selected_item = selected_items[0]
        item_index = self.tree.index(selected_item)
        item_data = self.invoice_items[item_index]
        
        # ูุชุญ ูุงูุฐุฉ ุชุนุฏูู ุงูุนูุตุฑ
        item_window = InvoiceItemWindow(self, item_data)
        self.wait_window(item_window)
        
        if hasattr(item_window, 'item_data') and item_window.item_data:
            # ุชุญุฏูุซ ุงูุนูุตุฑ ูู ุงููุงุฆูุฉ
            self.invoice_items[item_index] = item_window.item_data
            
            # ุชุญุฏูุซ ุงูุนูุตุฑ ูู ุงูุฌุฏูู
            self.tree.item(selected_item, values=(
                item_window.item_data['description'],
                item_window.item_data['quantity'],
                item_window.item_data['unit_price'],
                item_window.item_data['quantity'] * item_window.item_data['unit_price']
            ))
            
            # ุชุญุฏูุซ ุงููุฌููุน
            self.update_total()
    
    def remove_item(self):
        # ุงูุชุญูู ูู ุชุญุฏูุฏ ุนูุตุฑ
        selected_items = self.tree.selection()
        if not selected_items:
            messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุชุญุฏูุฏ ุนูุตุฑ ููุญุฐู")
            return
        
        # ุงูุญุตูู ุนูู ุงูุนูุตุฑ ุงููุญุฏุฏ
        selected_item = selected_items[0]
        item_index = self.tree.index(selected_item)
        
        # ุญุฐู ุงูุนูุตุฑ ูู ุงููุงุฆูุฉ
        self.invoice_items.pop(item_index)
        
        # ุญุฐู ุงูุนูุตุฑ ูู ุงูุฌุฏูู
        self.tree.delete(selected_item)
        
        # ุชุญุฏูุซ ุงููุฌููุน
        self.update_total()
    
    def update_total(self):
        # ุญุณุงุจ ุงููุฌููุน
        total = sum(item['quantity'] * item['unit_price'] for item in self.invoice_items)
        self.total_value.configure(text=str(total))
    
    def save_invoice(self):
        try:
            # ุงูุชุญูู ูู ุงุฎุชูุงุฑ ุนุถู
            member_id = self.member.id if self.member else (self.selected_member.id if self.selected_member else None)
            if not member_id:
                messagebox.showerror("ุฎุทุฃ", "ูุฑุฌู ุงุฎุชูุงุฑ ุนุถู")
                return
            
            # ุงูุชุญูู ูู ูุฌูุฏ ุนูุงุตุฑ
            if not self.invoice_items:
                messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุฅุถุงูุฉ ุนูุงุตุฑ ูููุงุชูุฑุฉ")
                return
            
            # ุงูุญุตูู ุนูู ููู ุงููููุฐุฌ
            total_amount = float(self.total_value.cget("text"))
            paid_amount = float(self.paid_amount_entry.get() or 0)
            notes = self.notes_entry.get()
            
            # ุฅูุดุงุก ุจูุงูุงุช ุงููุงุชูุฑุฉ
            invoice_data = {
                'member_id': member_id,
                'total_amount': total_amount,
                'paid_amount': paid_amount,
                'notes': notes,
                'items': self.invoice_items
            }
            
            # ุญูุธ ุงููุงุชูุฑุฉ
            result = self.invoice_controller.create_invoice(invoice_data)
            
            if result['success']:
                messagebox.showinfo("ูุฌุงุญ", "ุชู ุฅูุดุงุก ุงููุงุชูุฑุฉ ุจูุฌุงุญ")
                self.destroy()
                return result['invoice']
            else:
                messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ: {result['error']}")
                return None
        
        except Exception as e:
            messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน: {str(e)}")
            return None
    
    def save_and_print(self):
        # ุญูุธ ุงููุงุชูุฑุฉ
        invoice = self.save_invoice()
        if not invoice:
            return
        
        # ุฅูุดุงุก ููู PDF
        result = self.invoice_controller.generate_invoice_pdf(invoice.id)
        if result['success']:
            # ูุชุญ ููู PDF
            os.startfile(result['pdf_path'])
        else:
            messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅูุดุงุก ููู PDF: {result['error']}")
```

### 3. ุนุฑุถ ูุฅูุดุงุก ุงูุชูุงุฑูุฑ

```python
# app/controllers/report_controller.py
class ReportController:
    def __init__(self, db_service, report_service):
        self.db_service = db_service
        self.report_service = report_service
    
    def generate_financial_report(self, start_date, end_date, report_type='summary'):
        try:
            # ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ุงููุงููุฉ
            invoices = self.db_service.get_invoices_by_date_range(start_date, end_date)
            payments = self.db_service.get_payments_by_date_range(start_date, end_date)
            expenses = self.db_service.get_expenses_by_date_range(start_date, end_date)
            
            # ุฅูุดุงุก ุงูุชูุฑูุฑ
            report_data = self.report_service.generate_financial_report(
                invoices, payments, expenses, report_type
            )
            
            return {'success': True, 'report_data': report_data}
        except Exception as e:
            return {'success': False, 'error': str(e)}
    
    def generate_member_report(self, start_date, end_date, report_type='summary'):
        try:
            # ุงูุญุตูู ุนูู ุจูุงูุงุช ุงูุฃุนุถุงุก
            members = self.db_service.get_members_by_date_range(start_date, end_date)
            subscriptions = self.db_service.get_subscriptions_by_date_range(start_date, end_date)
            attendance = self.db_service.get_attendance_by_date_range(start_date, end_date)
            
            # ุฅูุดุงุก ุงูุชูุฑูุฑ
            report_data = self.report_service.generate_member_report(
                members, subscriptions, attendance, report_type
            )
            
            return {'success': True, 'report_data': report_data}
        except Exception as e:
            return {'success': False, 'error': str(e)}
    
    def export_report_to_excel(self, report_data, file_path):
        try:
            # ุชุตุฏูุฑ ุงูุชูุฑูุฑ ุฅูู ููู Excel
            self.report_service.export_to_excel(report_data, file_path)
            return {'success': True, 'file_path': file_path}
        except Exception as e:
            return {'success': False, 'error': str(e)}

# app/views/report_view.py
class ReportFrame(ctk.CTkFrame):
    def __init__(self, parent, report_controller):
        super().__init__(parent)
        self.report_controller = report_controller
        
        # ุฅูุดุงุก ุนูุงุตุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู
        self.title_label = ctk.CTkLabel(self, text="ุงูุชูุงุฑูุฑ", font=ctk.CTkFont(size=20, weight="bold"))
        self.title_label.pack(pady=10)
        
        # ุฅุทุงุฑ ูุนุงููุฑ ุงูุชูุฑูุฑ
        self.criteria_frame = ctk.CTkFrame(self)
        self.criteria_frame.pack(fill="x", padx=20, pady=10)
        
        # ููุน ุงูุชูุฑูุฑ
        self.report_type_label = ctk.CTkLabel(self.criteria_frame, text="ููุน ุงูุชูุฑูุฑ:")
        self.report_type_label.grid(row=0, column=0, padx=10, pady=10, sticky="e")
        
        self.report_type_var = ctk.StringVar(value="financial")
        self.report_type_financial = ctk.CTkRadioButton(self.criteria_frame, text="ุชูุฑูุฑ ูุงูู", variable=self.report_type_var, value="financial")
        self.report_type_financial.grid(row=0, column=1, padx=10, pady=10, sticky="w")
        
        self.report_type_member = ctk.CTkRadioButton(self.criteria_frame, text="ุชูุฑูุฑ ุงูุฃุนุถุงุก", variable=self.report_type_var, value="member")
        self.report_type_member.grid(row=0, column=2, padx=10, pady=10, sticky="w")
        
        # ูุณุชูู ุงูุชูุงุตูู
        self.detail_level_label = ctk.CTkLabel(self.criteria_frame, text="ูุณุชูู ุงูุชูุงุตูู:")
        self.detail_level_label.grid(row=1, column=0, padx=10, pady=10, sticky="e")
        
        self.detail_level_var = ctk.StringVar(value="summary")
        self.detail_level_summary = ctk.CTkRadioButton(self.criteria_frame, text="ููุฎุต", variable=self.detail_level_var, value="summary")
        self.detail_level_summary.grid(row=1, column=1, padx=10, pady=10, sticky="w")
        
        self.detail_level_detailed = ctk.CTkRadioButton(self.criteria_frame, text="ุชูุตููู", variable=self.detail_level_var, value="detailed")
        self.detail_level_detailed.grid(row=1, column=2, padx=10, pady=10, sticky="w")
        
        # ุงููุชุฑุฉ ุงูุฒูููุฉ
        self.date_range_label = ctk.CTkLabel(self.criteria_frame, text="ุงููุชุฑุฉ ุงูุฒูููุฉ:")
        self.date_range_label.grid(row=2, column=0, padx=10, pady=10, sticky="e")
        
        self.date_range_var = ctk.StringVar(value="month")
        self.date_range_month = ctk.CTkRadioButton(self.criteria_frame, text="ุงูุดูุฑ ุงูุญุงูู", variable=self.date_range_var, value="month")
        self.date_range_month.grid(row=2, column=1, padx=10, pady=10, sticky="w")
        
        self.date_range_quarter = ctk.CTkRadioButton(self.criteria_frame, text="ุงูุฑุจุน ุงูุญุงูู", variable=self.date_range_var, value="quarter")
        self.date_range_quarter.grid(row=2, column=2, padx=10, pady=10, sticky="w")
        
        self.date_range_year = ctk.CTkRadioButton(self.criteria_frame, text="ุงูุณูุฉ ุงูุญุงููุฉ", variable=self.date_range_var, value="year")
        self.date_range_year.grid(row=2, column=3, padx=10, pady=10, sticky="w")
        
        self.date_range_custom = ctk.CTkRadioButton(self.criteria_frame, text="ูุฎุตุต", variable=self.date_range_var, value="custom")
        self.date_range_custom.grid(row=2, column=4, padx=10, pady=10, sticky="w")
        
        # ุชูุงุฑูุฎ ูุฎุตุตุฉ
        self.custom_dates_frame = ctk.CTkFrame(self.criteria_frame)
        self.custom_dates_frame.grid(row=3, column=1, columnspan=4, padx=10, pady=10, sticky="w")
        
        self.start_date_label = ctk.CTkLabel(self.custom_dates_frame, text="ูู:")
        self.start_date_label.pack(side="left", padx=5)
        
        today = datetime.date.today()
        
        self.start_date_frame = ctk.CTkFrame(self.custom_dates_frame)
        self.start_date_frame.pack(side="left", padx=5)
        
        self.start_day = ctk.CTkComboBox(self.start_date_frame, values=[str(i) for i in range(1, 32)], width=60)
        self.start_day.set("1")
        self.start_day.pack(side="right", padx=2)
        
        self.start_month = ctk.CTkComboBox(self.start_date_frame, values=[str(i) for i in range(1, 13)], width=60)
        self.start_month.set(str(today.month))
        self.start_month.pack(side="right", padx=2)
        
        self.start_year = ctk.CTkComboBox(self.start_date_frame, values=[str(i) for i in range(today.year - 5, today.year + 1)], width=80)
        self.start_year.set(str(today.year))
        self.start_year.pack(side="right", padx=2)
        
        self.end_date_label = ctk.CTkLabel(self.custom_dates_frame, text="ุฅูู:")
        self.end_date_label.pack(side="left", padx=5)
        
        self.end_date_frame = ctk.CTkFrame(self.custom_dates_frame)
        self.end_date_frame.pack(side="left", padx=5)
        
        self.end_day = ctk.CTkComboBox(self.end_date_frame, values=[str(i) for i in range(1, 32)], width=60)
        self.end_day.set(str(today.day))
        self.end_day.pack(side="right", padx=2)
        
        self.end_month = ctk.CTkComboBox(self.end_date_frame, values=[str(i) for i in range(1, 13)], width=60)
        self.end_month.set(str(today.month))
        self.end_month.pack(side="right", padx=2)
        
        self.end_year = ctk.CTkComboBox(self.end_date_frame, values=[str(i) for i in range(today.year - 5, today.year + 1)], width=80)
        self.end_year.set(str(today.year))
        self.end_year.pack(side="right", padx=2)
        
        # ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช
        self.actions_frame = ctk.CTkFrame(self)
        self.actions_frame.pack(fill="x", padx=20, pady=10)
        
        self.generate_button = ctk.CTkButton(self.actions_frame, text="ุฅูุดุงุก ุงูุชูุฑูุฑ", command=self.generate_report)
        self.generate_button.pack(side="left", padx=10)
        
        self.export_excel_button = ctk.CTkButton(self.actions_frame, text="ุชุตุฏูุฑ ุฅูู Excel", command=self.export_to_excel)
        self.export_excel_button.pack(side="left", padx=10)
        self.export_excel_button.configure(state="disabled")
        
        self.export_pdf_button = ctk.CTkButton(self.actions_frame, text="ุชุตุฏูุฑ ุฅูู PDF", command=self.export_to_pdf)
        self.export_pdf_button.pack(side="left", padx=10)
        self.export_pdf_button.configure(state="disabled")
        
        # ุฅุทุงุฑ ุนุฑุถ ุงูุชูุฑูุฑ
        self.report_frame = ctk.CTkFrame(self)
        self.report_frame.pack(fill="both", expand=True, padx=20, pady=10)
        
        self.report_label = ctk.CTkLabel(self.report_frame, text="ูุชุงุฆุฌ ุงูุชูุฑูุฑ", font=ctk.CTkFont(weight="bold"))
        self.report_label.pack(pady=5)
        
        # ูุณุงุญุฉ ุนุฑุถ ุงูุชูุฑูุฑ (ุชุฎุชูู ุญุณุจ ููุน ุงูุชูุฑูุฑ)
        self.report_content_frame = ctk.CTkFrame(self.report_frame)
        self.report_content_frame.pack(fill="both", expand=True, padx=10, pady=5)
        
        # ุญุงูุฉ ุงูุชูุฑูุฑ ุงูุญุงูู
        self.current_report_data = None
    
    def generate_report(self):
        try:
            # ุงูุญุตูู ุนูู ูุนุงููุฑ ุงูุชูุฑูุฑ
            report_type = self.report_type_var.get()
            detail_level = self.detail_level_var.get()
            date_range = self.date_range_var.get()
            
            # ุชุญุฏูุฏ ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
            today = datetime.date.today()
            start_date = None
            end_date = today
            
            if date_range == "month":
                start_date = datetime.date(today.year, today.month, 1)
            elif date_range == "quarter":
                quarter_month = ((today.month - 1) // 3) * 3 + 1
                start_date = datetime.date(today.year, quarter_month, 1)
            elif date_range == "year":
                start_date = datetime.date(today.year, 1, 1)
            elif date_range == "custom":
                try:
                    start_date = datetime.date(
                        int(self.start_year.get()),
                        int(self.start_month.get()),
                        int(self.start_day.get())
                    )
                    end_date = datetime.date(
                        int(self.end_year.get()),
                        int(self.end_month.get()),
                        int(self.end_day.get())
                    )
                except ValueError:
                    messagebox.showerror("ุฎุทุฃ", "ุชุงุฑูุฎ ุบูุฑ ุตุงูุญ")
                    return
            
            # ุฅูุดุงุก ุงูุชูุฑูุฑ
            if report_type == "financial":
                result = self.report_controller.generate_financial_report(start_date, end_date, detail_level)
            else:  # member
                result = self.report_controller.generate_member_report(start_date, end_date, detail_level)
            
            if result['success']:
                self.current_report_data = result['report_data']
                self.display_report(self.current_report_data, report_type)
                self.export_excel_button.configure(state="normal")
                self.export_pdf_button.configure(state="normal")
            else:
                messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅูุดุงุก ุงูุชูุฑูุฑ: {result['error']}")
        
        except Exception as e:
            messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน: {str(e)}")
    
    def display_report(self, report_data, report_type):
        # ูุณุญ ุงููุญุชูู ุงูุญุงูู
        for widget in self.report_content_frame.winfo_children():
            widget.destroy()
        
        # ุนุฑุถ ุงูุชูุฑูุฑ ุญุณุจ ุงูููุน
        if report_type == "financial":
            self.display_financial_report(report_data)
        else:  # member
            self.display_member_report(report_data)
    
    def display_financial_report(self, report_data):
        # ุฅูุดุงุก ุฌุฏูู ูุนุฑุถ ุงูุจูุงูุงุช ุงููุงููุฉ
        columns = ("category", "amount")
        tree = ttk.Treeview(self.report_content_frame, columns=columns, show="headings")
        
        # ุชุนููู ุนูุงููู ุงูุฃุนูุฏุฉ
        tree.heading("category", text="ุงููุฆุฉ")
        tree.heading("amount", text="ุงููุจูุบ")
        
        # ุชุนููู ุฃุญุฌุงู ุงูุฃุนูุฏุฉ
        tree.column("category", width=200)
        tree.column("amount", width=150)
        
        # ุฅุถุงูุฉ ุงูุจูุงูุงุช
        tree.insert("", "end", values=("ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช", report_data['total_income']))
        tree.insert("", "end", values=("ุฅุฌูุงูู ุงููุตุฑููุงุช", report_data['total_expenses']))
        tree.insert("", "end", values=("ุตุงูู ุงูุฑุจุญ", report_data['net_profit']))
        
        # ุฅุถุงูุฉ ุชูุงุตูู ุงูุฅูุฑุงุฏุงุช
        income_parent = tree.insert("", "end", values=("ุชูุงุตูู ุงูุฅูุฑุงุฏุงุช", ""))
        for category, amount in report_data['income_by_category'].items():
            tree.insert(income_parent, "end", values=(category, amount))
        
        # ุฅุถุงูุฉ ุชูุงุตูู ุงููุตุฑููุงุช
        expenses_parent = tree.insert("", "end", values=("ุชูุงุตูู ุงููุตุฑููุงุช", ""))
        for category, amount in report_data['expenses_by_category'].items():
            tree.insert(expenses_parent, "end", values=(category, amount))
        
        # ุฅุถุงูุฉ ุดุฑูุท ุงูุชูุฑูุฑ
        scrollbar = ttk.Scrollbar(self.report_content_frame, orient="vertical", command=tree.yview)
        tree.configure(yscrollcommand=scrollbar.set)
        scrollbar.pack(side="right", fill="y")
        tree.pack(side="left", fill="both", expand=True)
    
    def display_member_report(self, report_data):
        # ุฅูุดุงุก ุฌุฏูู ูุนุฑุถ ุจูุงูุงุช ุงูุฃุนุถุงุก
        columns = ("category", "value")
        tree = ttk.Treeview(self.report_content_frame, columns=columns, show="headings")
        
        # ุชุนููู ุนูุงููู ุงูุฃุนูุฏุฉ
        tree.heading("category", text="ุงููุฆุฉ")
        tree.heading("value", text="ุงููููุฉ")
        
        # ุชุนููู ุฃุญุฌุงู ุงูุฃุนูุฏุฉ
        tree.column("category", width=200)
        tree.column("value", width=150)
        
        # ุฅุถุงูุฉ ุงูุจูุงูุงุช
        tree.insert("", "end", values=("ุฅุฌูุงูู ุงูุฃุนุถุงุก", report_data['total_members']))
        tree.insert("", "end", values=("ุงูุฃุนุถุงุก ุงููุดุทูู", report_data['active_members']))
        tree.insert("", "end", values=("ุงูุฃุนุถุงุก ุงูุฌุฏุฏ", report_data['new_members']))
        tree.insert("", "end", values=("ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ", report_data['active_subscriptions']))
        tree.insert("", "end", values=("ูุชูุณุท ูุฏุฉ ุงูุญุถูุฑ", f"{report_data['avg_attendance_duration']} ุฏูููุฉ"))
        
        # ุฅุถุงูุฉ ุชูุงุตูู ุงูุงุดุชุฑุงูุงุช
        subscriptions_parent = tree.insert("", "end", values=("ุงูุงุดุชุฑุงูุงุช ุญุณุจ ุงูุฎุทุฉ", ""))
        for plan, count in report_data['subscriptions_by_plan'].items():
            tree.insert(subscriptions_parent, "end", values=(plan, count))
        
        # ุฅุถุงูุฉ ุดุฑูุท ุงูุชูุฑูุฑ
        scrollbar = ttk.Scrollbar(self.report_content_frame, orient="vertical", command=tree.yview)
        tree.configure(yscrollcommand=scrollbar.set)
        scrollbar.pack(side="right", fill="y")
        tree.pack(side="left", fill="both", expand=True)
    
    def export_to_excel(self):
        if not self.current_report_data:
            messagebox.showwarning("ุชูุจูู", "ูุฑุฌู ุฅูุดุงุก ุชูุฑูุฑ ุฃููุงู")
            return
        
        # ุงุฎุชูุงุฑ ูุณุงุฑ ุงูููู
        file_path = filedialog.asksaveasfilename(
            defaultextension=".xlsx",
            filetypes=[("Excel files", "*.xlsx")],
            title="ุญูุธ ุงูุชูุฑูุฑ ูููู Excel"
        )
        
        if not file_path:
            return
        
        # ุชุตุฏูุฑ ุงูุชูุฑูุฑ
        result = self.report_controller.export_report_to_excel(self.current_report_data, file_path)
        
        if result['success']:
            messagebox.showinfo("ูุฌุงุญ", f"ุชู ุชุตุฏูุฑ ุงูุชูุฑูุฑ ุจูุฌุงุญ ุฅูู {result['file_path']}")
            # ูุชุญ ุงูููู
            os.startfile(result['file_path'])
        else:
            messagebox.showerror("ุฎุทุฃ", f"ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุตุฏูุฑ ุงูุชูุฑูุฑ: {result['error']}")
    
    def export_to_pdf(self):
        # ููุงุซู ูุชุตุฏูุฑ Excel ูููู ุจุงุณุชุฎุฏุงู PDF
        pass
```

## ๐ ุชูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 1. ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ

```python
# app/services/db_service.py
class DatabaseService:
    def __init__(self, db_path):
        self.db_path = db_path
        self.engine = create_engine(f'sqlite:///{db_path}')
        self.Session = sessionmaker(bind=self.engine)
        self.session = self.Session()
    
    def init_db(self):
        # ุฅูุดุงุก ุฌููุน ุงูุฌุฏุงูู
        Base.metadata.create_all(self.engine)
    
    def migrate_db(self, old_db_path):
        # ุชุฑุญูู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุฏููุฉ ุฅูู ุงูุฌุฏูุฏุฉ
        old_engine = create_engine(f'sqlite:///{old_db_path}')
        old_session = sessionmaker(bind=old_engine)()
        
        # ุชุฑุญูู ุงูุฃุนุถุงุก
        old_members = old_session.query(Member).all()
        for member in old_members:
            self.session.add(member)
        
        # ุชุฑุญูู ุฎุทุท ุงูุนุถููุฉ
        old_plans = old_session.query(MembershipPlan).all()
        for plan in old_plans:
            self.session.add(plan)
        
        # ุชุฑุญูู ุงูุงุดุชุฑุงูุงุช
        old_subscriptions = old_session.query(Subscription).all()
        for subscription in old_subscriptions:
            self.session.add(subscription)
        
        # ุชุฑุญูู ุณุฌูุงุช ุงูุญุถูุฑ
        old_attendance = old_session.query(Attendance).all()
        for attendance in old_attendance:
            self.session.add(attendance)
        
        # ุชุฑุญูู ุงูููุงุชูุฑ
        old_invoices = old_session.query(Invoice).all()
        for invoice in old_invoices:
            self.session.add(invoice)
        
        # ุชุฑุญูู ุนูุงุตุฑ ุงูููุงุชูุฑ
        old_invoice_items = old_session.query(InvoiceItem).all()
        for item in old_invoice_items:
            self.session.add(item)
        
        # ุชุฑุญูู ุงููุฏููุนุงุช
        old_payments = old_session.query(Payment).all()
        for payment in old_payments:
            self.session.add(payment)
        
        # ุชุฑุญูู ุงููุตุฑููุงุช
        old_expenses = old_session.query(Expense).all()
        for expense in old_expenses:
            self.session.add(expense)
        
        # ุชุฑุญูู ุงูููุชุฌุงุช
        old_products = old_session.query(Product).all()
        for product in old_products:
            self.session.add(product)
        
        # ุชุฑุญูู ุงููุจูุนุงุช
        old_sales = old_session.query(Sale).all()
        for sale in old_sales:
            self.session.add(sale)
        
        # ุชุฑุญูู ุนูุงุตุฑ ุงููุจูุนุงุช
        old_sale_items = old_session.query(SaleItem).all()
        for item in old_sale_items:
            self.session.add(item)
        
        # ุชุฑุญูู ุงููุณุชุฎุฏููู
        old_users = old_session.query(User).all()
        for user in old_users:
            self.session.add(user)
        
        # ุชุฑุญูู ุงูุฅุนุฏุงุฏุงุช
        old_settings = old_session.query(GymSettings).all()
        for setting in old_settings:
            self.session.add(setting)
        
        # ุญูุธ ุงูุชุบููุฑุงุช
        self.session.commit()
        
        old_session.close()
```

## ๐ ุชูููู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุฆูุณูุฉ

### 1. ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ

```python
# app/views/main_window.py
class MainWindow(ctk.CTk):
    def __init__(self, app_controller):
        super().__init__()
        self.app_controller = app_controller
        
        # ุฅุนุฏุงุฏ ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
        self.title("ูุธุงู ุฅุฏุงุฑุฉ ุงููุงุฏู ุงูุฑูุงุถู")
        self.geometry("1200x800")
        
        # ุชุนููู ุงูุณูุฉ
        ctk.set_appearance_mode("dark")  # ุงููุถุน: "light" ุฃู "dark"
        ctk.set_default_color_theme("blue")  # ุงูุณูุฉ: "blue", "green", "dark-blue"
        
        # ุฅูุดุงุก ุงูุฅุทุงุฑ ุงูุฑุฆูุณู
        self.main_frame = ctk.CTkFrame(self)
        self.main_frame.pack(fill="both", expand=True)
        
        # ุฅูุดุงุก ุงูุดุฑูุท ุงูุฌุงูุจู
        self.sidebar_frame = ctk.CTkFrame(self.main_frame, width=200)
        self.sidebar_frame.pack(side="right", fill="y")
        
        # ุดุนุงุฑ ุงููุงุฏู
        self.logo_label = ctk.CTkLabel(self.sidebar_frame, text="ุงููุงุฏู ุงูุฑูุงุถู", font=ctk.CTkFont(size=20, weight="bold"))
        self.logo_label.pack(pady=20)
        
        # ุฃุฒุฑุงุฑ ุงููุงุฆูุฉ
        self.dashboard_button = ctk.CTkButton(self.sidebar_frame, text="ููุญุฉ ุงูุชุญูู", command=lambda: self.show_frame("dashboard"))
        self.dashboard_button.pack(pady=10, padx=20, fill="x")
        
        self.members_button = ctk.CTkButton(self.sidebar_frame, text="ุงูุฃุนุถุงุก", command=lambda: self.show_frame("members"))
        self.members_button.pack(pady=10, padx=20, fill="x")
        
        self.subscriptions_button = ctk.CTkButton(self.sidebar_frame, text="ุงูุงุดุชุฑุงูุงุช", command=lambda: self.show_frame("subscriptions"))
        self.subscriptions_button.pack(pady=10, padx=20, fill="x")
        
        self.attendance_button = ctk.CTkButton(self.sidebar_frame, text="ุงูุญุถูุฑ ูุงูุงูุตุฑุงู", command=lambda: self.show_frame("attendance"))
        self.attendance_button.pack(pady=10, padx=20, fill="x")
        
        self.invoices_button = ctk.CTkButton(self.sidebar_frame, text="ุงูููุงุชูุฑ", command=lambda: self.show_frame("invoices"))
        self.invoices_button.pack(pady=10, padx=20, fill="x")
        
        self.reports_button = ctk.CTkButton(self.sidebar_frame, text="ุงูุชูุงุฑูุฑ", command=lambda: self.show_frame("reports"))
        self.reports_button.pack(pady=10, padx=20, fill="x")
        
        self.inventory_button = ctk.CTkButton(self.sidebar_frame, text="ุงููุฎุฒูู ูุงููุจูุนุงุช", command=lambda: self.show_frame("inventory"))
        self.inventory_button.pack(pady=10, padx=20, fill="x")
        
        self.settings_button = ctk.CTkButton(self.sidebar_frame, text="ุงูุฅุนุฏุงุฏุงุช", command=lambda: self.show_frame("settings"))
        self.settings_button.pack(pady=10, padx=20, fill="x")
        
        # ูุนูููุงุช ุงููุณุชุฎุฏู
        self.user_frame = ctk.CTkFrame(self.sidebar_frame)
        self.user_frame.pack(side="bottom", fill="x", padx=20, pady=20)
        
        self.user_label = ctk.CTkLabel(self.user_frame, text="ูุฑุญุจุงูุ ุงููุณุชุฎุฏู")
        self.user_label.pack(pady=5)
        
        self.logout_button = ctk.CTkButton(self.user_frame, text="ุชุณุฌูู ุงูุฎุฑูุฌ", command=self.logout)
        self.logout_button.pack(pady=5)
        
        # ุฅูุดุงุก ุฅุทุงุฑ ุงููุญุชูู
        self.content_frame = ctk.CTkFrame(self.main_frame)
        self.content_frame.pack(side="left", fill="both", expand=True)
        
        # ุฅูุดุงุก ุงูุฅุทุงุฑุงุช ุงููุฎุชููุฉ
        self.frames = {}
        
        # ุชุญููู ุงูุฅุทุงุฑ ุงูุงูุชุฑุงุถู (ููุญุฉ ุงูุชุญูู)
        self.current_frame = None
        self.load_frames()
        self.show_frame("dashboard")
    
    def load_frames(self):
        # ุฅูุดุงุก ูุญุฏุงุช ุงูุชุญูู ููุฅุทุงุฑุงุช ุงููุฎุชููุฉ
        member_controller = self.app_controller.get_member_controller()
        subscription_controller = self.app_controller.get_subscription_controller()
        attendance_controller = self.app_controller.get_attendance_controller()
        invoice_controller = self.app_controller.get_invoice_controller()
        report_controller = self.app_controller.get_report_controller()
        inventory_controller = self.app_controller.get_inventory_controller()
        settings_controller = self.app_controller.get_settings_controller()
        
        # ุฅูุดุงุก ุงูุฅุทุงุฑุงุช
        from app.views.dashboard_view import DashboardFrame
        from app.views.members_view import MembersListFrame
        from app.views.subscription_view import SubscriptionsListFrame
        from app.views.attendance_view import AttendanceFrame
        from app.views.invoice_view import InvoicesListFrame
        from app.views.report_view import ReportFrame
        from app.views.inventory_view import InventoryFrame
        from app.views.settings_view import SettingsFrame
        
        self.frames["dashboard"] = DashboardFrame(self.content_frame, self.app_controller)
        self.frames["members"] = MembersListFrame(self.content_frame, member_controller)
        self.frames["subscriptions"] = SubscriptionsListFrame(self.content_frame, subscription_controller)
        self.frames["attendance"] = AttendanceFrame(self.content_frame, attendance_controller)
        self.frames["invoices"] = InvoicesListFrame(self.content_frame, invoice_controller)
        self.frames["reports"] = ReportFrame(self.content_frame, report_controller)
        self.frames["inventory"] = InventoryFrame(self.content_frame, inventory_controller)
        self.frames["settings"] = SettingsFrame(self.content_frame, settings_controller)
    
    def show_frame(self, frame_name):
        # ุฅุฎูุงุก ุงูุฅุทุงุฑ ุงูุญุงูู
        if self.current_frame:
            self.frames[self.current_frame].pack_forget()
        
        # ุนุฑุถ ุงูุฅุทุงุฑ ุงูุฌุฏูุฏ
        self.frames[frame_name].pack(fill="both", expand=True)
        self.current_frame = frame_name
    
    def logout(self):
        # ุชุณุฌูู ุงูุฎุฑูุฌ
        self.app_controller.logout()
        self.destroy()
        
        # ูุชุญ ูุงูุฐุฉ ุชุณุฌูู ุงูุฏุฎูู
        from app.views.auth_view import LoginWindow
        login_window = LoginWindow(None, self.app_controller.get_auth_controller())
        login_window.mainloop()
```

## ๐ ููุทุฉ ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ ููุชุทุจูู

```python
# main.py
import os
import customtkinter as ctk
from app.controllers.app_controller import AppController
from app.views.auth_view import LoginWindow
from app.views.main_window import MainWindow

def main():
    # ุฅูุดุงุก ูุณุงุฑุงุช ุงูุชุทุจูู ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
    os.makedirs("database", exist_ok=True)
    os.makedirs("logs", exist_ok=True)
    os.makedirs("exports", exist_ok=True)
    os.makedirs("temp", exist_ok=True)
    
    # ุฅูุดุงุก ูุญุฏุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ ููุชุทุจูู
    app_controller = AppController()
    
    # ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
    app_controller.init_database()
    
    # ุฅูุดุงุก ูุงูุฐุฉ ุชุณุฌูู ุงูุฏุฎูู
    login_window = LoginWindow(None, app_controller.get_auth_controller())
    login_window.mainloop()

if __name__ == "__main__":
    main()
```

## ๐ ุชุญุฏูุงุช ุงูุชุญููู ูุงูุญููู

### 1. ุชุญููู ููุงุฐุฌ HTML ุฅูู CustomTkinter

| ููุน ุงูุนูุตุฑ ูู HTML | ุงูููุงูุฆ ูู CustomTkinter |
|-------------------|---------------------------|
| `<input type="text">` | `ctk.CTkEntry()` |
| `<input type="password">` | `ctk.CTkEntry(show="*")` |
| `<input type="checkbox">` | `ctk.CTkCheckBox()` |
| `<input type="radio">` | `ctk.CTkRadioButton()` |
| `<select>` | `ctk.CTkComboBox()` |
| `<textarea>` | `ctk.CTkTextbox()` |
| `<button>` | `ctk.CTkButton()` |
| `<table>` | `ttk.Treeview()` |
| `<div>` | `ctk.CTkFrame()` |
| `<label>` | `ctk.CTkLabel()` |

### 2. ุชุญููู ุทูุจุงุช HTTP ุฅูู ุงุณุชุฏุนุงุกุงุช ูุจุงุดุฑุฉ

| ููุท Flask | ููุท CustomTkinter |
|-----------|-------------------|
| `@app.route('/members')` | `def show_members_frame(self):` |
| `request.form.get('name')` | `self.name_entry.get()` |
| `return render_template('members.html', members=members)` | `self.display_members(members)` |
| `redirect(url_for('members'))` | `self.show_frame('members')` |
| `flash('ุชู ุงูุญูุธ ุจูุฌุงุญ')` | `messagebox.showinfo('ูุฌุงุญ', 'ุชู ุงูุญูุธ ุจูุฌุงุญ')` |

### 3. ุชุญููู ุงููุตุงุฏูุฉ ูุงูุฌูุณุงุช

| ุขููุฉ Flask | ุขููุฉ CustomTkinter |
|------------|--------------------|
| `flask_login` | ูุตุงุฏูุฉ ูุญููุฉ ูุชุฎุฒูู ุงููุณุชุฎุฏู ุงูุญุงูู ูู ุงูุฐุงูุฑุฉ |
| `session['user_id']` | `self.current_user` |
| `@login_required` | ูุญุต `self.current_user` ูุจู ุชูููุฐ ุงูุนูููุงุช |

## ๐ ุงุฎุชุจุงุฑ ูุถูุงู ุงูุฌูุฏุฉ

### 1. ุงุณุชุฑุงุชูุฌูุฉ ุงูุงุฎุชุจุงุฑ

1. **ุงุฎุชุจุงุฑ ุงููุญุฏุงุช**: ุงุฎุชุจุงุฑ ูู ูุญุฏุฉ ุชุญูู ููููุฐุฌ ุจุดูู ูููุตู.
2. **ุงุฎุชุจุงุฑ ุงูุชูุงูู**: ุงุฎุชุจุงุฑ ุชูุงุนู ุงูููููุงุช ุงููุฎุชููุฉ ูุน ุจุนุถูุง ุงูุจุนุถ.
3. **ุงุฎุชุจุงุฑ ูุงุฌูุฉ ุงููุณุชุฎุฏู**: ุงุฎุชุจุงุฑ ุณูููุฉ ุงุณุชุฎุฏุงู ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุชุฌุฑุจุฉ ุงููุณุชุฎุฏู.
4. **ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก**: ููุงุณ ุฃุฏุงุก ุงูุชุทุจูู ูุชุญุณููู.

### 2. ูุงุฆูุฉ ุงูุชุญูู ููุงุฎุชุจุงุฑ

- [ ] ุชุณุฌูู ุงูุฏุฎูู ูุงูุฎุฑูุฌ
- [ ] ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก (ุฅุถุงูุฉุ ุชุนุฏููุ ุญุฐูุ ุจุญุซ)
- [ ] ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช (ุฅุถุงูุฉุ ุชุนุฏููุ ุชุฌุฏูุฏ)
- [ ] ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- [ ] ุฅูุดุงุก ูุทุจุงุนุฉ ุงูููุงุชูุฑ
- [ ] ุฅูุดุงุก ูุชุตุฏูุฑ ุงูุชูุงุฑูุฑ
- [ ] ุฅุฏุงุฑุฉ ุงููุฎุฒูู ูุงููุจูุนุงุช
- [ ] ุฅุนุฏุงุฏุงุช ุงููุธุงู

## ๐ฆ ุงูุชูุฒูุน ูุงูุชุซุจูุช

### 1. ุฅูุดุงุก ุญุฒูุฉ ูุงุจูุฉ ููุชูููุฐ

```python
# setup.py
from setuptools import setup, find_packages

setup(
    name="gymawy-desktop",
    version="1.0.0",
    packages=find_packages(),
    install_requires=[
        "customtkinter>=5.0.0",
        "sqlalchemy>=2.0.0",
        "pillow>=9.0.0",
        "reportlab>=3.6.0",
        "openpyxl>=3.0.0",
        "bcrypt>=4.0.0"
    ],
    entry_points={
        'console_scripts': [
            'gymawy-desktop=main:main',
        ],
    },
)
```

### 2. ุฅูุดุงุก ููู ุชูููุฐู ุจุงุณุชุฎุฏุงู PyInstaller

```bash
pyinstaller --name="Gymawy" --windowed --icon=app/assets/icon.ico --add-data="app/assets;app/assets" main.py
```

## ๐ ุงูุฎูุงุตุฉ

ุชุญููู ุชุทุจูู ููุจ Flask ุฅูู ุชุทุจูู ุณุทุญ ููุชุจ CustomTkinter ูู ุนูููุฉ ูููุฌูุฉ ุชุชุทูุจ ุชุฎุทูุทูุง ุฏููููุง ูุชูููุฐูุง ูุฑุญูููุง. ุจุงุชุจุงุน ุงูุฎุทุฉ ุงูููุชุฑุญุฉุ ูููู ุงูุงุญุชูุงุธ ุจูุนุธู ุงูููุทู ุงูุชุฌุงุฑู ูุงููุธุงุฆู ุงูุญุงููุฉ ูุน ุชูููู ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุจูุฆุฉ ุณุทุญ ุงูููุชุจ. ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ุณุชููู ุชุทุจูููุง ูุงุฆููุง ุจุฐุงุชู ูุนูู ุจุฏูู ุงูุญุงุฌุฉ ุฅูู ุงุชุตุงู ุจุงูุฅูุชุฑูุช ููููุฑ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ููุนุงูุฉ.

ุงูููุชุงุญ ููุฌุงุญ ูุฐุง ุงูุชุญููู ูู ุงูุญูุงุธ ุนูู ููุท MVC ูุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูููุงุฐุฌ ูุงูุฎุฏูุงุช ูุฏุฑ ุงูุฅููุงูุ ูุน ุงูุชุฑููุฒ ุนูู ุฅุนุงุฏุฉ ุจูุงุก ูุงุฌูุงุช ุงููุณุชุฎุฏู ุจุงุณุชุฎุฏุงู CustomTkinter ูุชูููู ุขููุงุช ุงูุชุญูู ููุนูู ูู ุจูุฆุฉ ุณุทุญ ุงูููุชุจ.